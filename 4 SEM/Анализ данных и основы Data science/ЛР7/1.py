import numpy as np
import matplotlib.pyplot as plt
from scipy.stats import linregress

# Исходные данные
x = np.array([33, 40, 36, 60, 55, 80, 95, 70, 48, 53, 95, 75, 63, 112, 70])
y = np.array([13.8, 13.8, 14, 22.5, 24, 28, 32, 20.9, 22, 21.5, 32, 35, 24, 37.9, 27.5])

# Задание 2.1: Построить график зависимости между переменными
plt.scatter(x, y, label='Исходные данные')
plt.xlabel('Общая площадь квартиры, кв.м')
plt.ylabel('Рыночная стоимость квартиры, тыс. у.е.')
plt.title('2.1. Зависимость стоимости квартиры от площади с линией регрессии')
plt.grid(True)

# Задание 2.2: Рассчитать параметры уравнения регрессии методом наименьших квадратов
slope, intercept, r_value, p_value, std_err = linregress(x, y)

# Добавление линии регрессии
plt.plot(x, slope * x + intercept, color='red', label='Линия регрессии')

# Вывод коэффициентов регрессии
plt.text(50, 25, f'y = {slope:.2f}x + {intercept:.2f}', fontsize=10, color='red')

plt.legend()
plt.show()

# Вывод параметров уравнения регрессии
print("Задание 2.2")
print("Параметры уравнения регрессии:")
print("Наклон (slope):", slope)
print("Пересечение (intercept):", intercept)

# Задание 2.3: Оценить качество уравнения с помощью средней ошибки аппроксимации
predicted_y = slope * x + intercept
MAE = np.mean(np.abs(predicted_y - y))
print("Задание 2.3")
print("Средняя ошибка аппроксимации (MAE):", MAE)

# Задание 2.4: Найти коэффициент эластичности
elasticity = slope * np.mean(x) / np.mean(y)
print("Задание 2.4")
print("Коэффициент эластичности:", elasticity)

# Задание 2.5: Оценить тесноту связи между переменными с помощью показателей корреляции и детерминации
r_squared = r_value ** 2
print("Задание 2.5")
print("Коэффициент детерминации (R^2):", r_squared)
print("Коэффициент корреляции (r):", r_value)

# Задание 2.6: Оценить значимость коэффициентов корреляции и регрессии о критерию t-Стьюдента при уровне значимости α = 0.05
print("Задание 2.6")
print("p-value для наклона (slope):", p_value) 

# Задание 2.7: Охарактеризовать статистическую надежность результатов регрессионного анализа с использованием критерия F-Фишера при уровне значимости α = 0.05
print("Задание 2.7")
print("p-value для F-теста:", p_value)

# Задание 2.8: Определить прогнозное значение результативного признака
factor_value = 1.2 * np.mean(x)
predicted_result = slope * factor_value + intercept
print("Задание 2.8")
print("Прогнозное значение результативного признака при значении факторного признака 1.2 от его среднего уровня:", predicted_result)
