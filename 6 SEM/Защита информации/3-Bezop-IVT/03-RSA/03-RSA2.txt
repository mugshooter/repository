> # Демонстрация двух криптографических протоколов:> #> # (1) варианта генерации ключей методом RSA:> #   (a, rA) - открытые ключи абонента A,> #   (b, rB) - открытые ключи абонента B,> #   alpha   - закрытый ключ абонента A,> #   betta   - закрытый ключ абонента B;> #> # (2) передачи и приёма текста по методу RSA> #> # **************> with(numtheory);> # -----------------------------------------------------> # Абонент A выбирает два случайных простых числа p1, p2> # и случайное целое число 0<a<phA, (a,phA)=1.> # Ключи rA и a являются открытыми ключами> # ---------------------------------------> p1:=7643; p2:=8753;> rA:=p1*p2; phA:=phi(rA);> a:=9467;> igcd(a,phA);  # Проверка выбора открытого ключа a> #> # --------------------------------------> # Вычисление закрытого ключа alpha для A> alpha:=a &^ (phi(phA)-1) mod phA;> #> # -----------------------------------------------------> # Абонент B выбирает два случайных простых числа q1, q2> # и случайное целое число 0<b<phB, (b,phB)=1.> # Ключи rB и b являются открытыми ключами> # ------------------------------------------> q1:=170141183460469231731687303715884105727;> q2:=10350794431055162386718619237468234569;> rB:=q1*q2; phB:=phi(rB);> b:=182687704666362864775460604089535377456991567871;> igcd(b,phB); # Проверка выбора открытого ключа b> #> # --------------------------------------> # Вычисление закрытого ключа betta для B> betta:=b &^ (phi(phB)-1) mod phB;> #> # ------------------------------------> # Кодируемый текст (важно, чтобы m<rB)> m:=9563712352348897672389641396218609567172;> #> # --------------------------------------------> # Абонент A шифрует исходный текст (m1 - шифр)> # с помощью открытых ключей b и rB абонента B> m1:=m &^ b mod rB;> # ----------------------------------------------------------> # Абонент B расшифровывает закодированный текст m1 с помощью> # своего закрытого ключа betta и открытого ключа rB> m2:=m1 &^ betta mod rB;> # ---------------------> # Выполним проверку:> m-m2;                                    7643                                    8753                                  66899179                                  66882784                                    9467                                      1                                  30993427                   170141183460469231731687303715884105727                   10350794431055162386718619237468234569   1761096414255759626214007376557990993955085697884921213758143162   998032276663   1761096414255759626214007376557990993774593719993396819639737240   044679936368              182687704666362864775460604089535377456991567871                                      1   1651358683223688420561188009955823597594847807953854259478179905   981879730111                  9563712352348897672389641396218609567172   8325547160098721902333259378087867278412261375059204459447822394   2973656948                  9563712352348897672389641396218609567172                                      0