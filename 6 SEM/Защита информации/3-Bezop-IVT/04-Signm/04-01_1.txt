> # Демонстрация криптографического протокола электронной
> # RSA-подписи совместно с секретной передачей сообщения
> # (используется хэширование).
> #
> # Коллективное творчество (4 курс, 10.10.2020)
> # ********************************************
> with(numtheory):
> hash:= (x) -> x mod 7;   # Примитивное хэширование
> #                          (7 - магическое число)
> # -----------------------------------------------
> # Выбор первого открытого ключа M ("вручную")
> # -------------------------------------------
> p1:= nextprime(1013122341234123412341234123); 
> p2:= nextprime(10331231231241234123412341234123); 
> M:= p1*p2; 
> ifactor(M);              # Практически нереализуемая операция!
> #
> # ------------------------------------
> # Выбор закрытого ключа d1 ("вручную")
> # ------------------------------------
> d1:= 12347;
> igcd(d1,(p1-1)*(p2-1));  # Проверка правильности выбора D1
> #
> # ---------------------------------------------------
> # Выбор второго открытого ключа e с помощью закрытого
> # ключа d1: это результат решения сравнения
> #
> #  d1*e=1 (mod phi(M))
> #
> # ------------------------------------------------------
> e:= d1 &^ (phi(phi(M))-1) mod (phi(M));  # (d1,phi(M))=1
> #
> # Публикация ключа (e,M) (например, в интернете)...
> #
> # ----------------------------------------------------
> x:= 1234567890234234234223523452345234 mod M;  # Текст
> #
> # -------------------------------------------------------
> # Процесс передачи и приёма текста с электронной подписью
> # -------------------------------------------------------
> s:= hash(x) &^ d1 mod M;  # Вычисление подписи 
> # --------------------------------------------
> x1:= s &^ e mod M;        # Расшифрованный текст
> # --------------------------------------------------------------
> hash(x) - x1;             # Проверка текста на предмет искажения
> #
