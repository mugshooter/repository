> # Демонстрация реализации криптографического
> # протокола подписи "в с л е п у ю"
> # (05.10.2023)
> # ************
> restart:
> with(numtheory):
> #
> # -------------------------------------------------------
> # Получатель распределяет ключи для стандартной схемы RSA
> # -------------------------------------------------------
> p1:= nextprime(1012378978798971231123142342423423242142); 
> p2:= nextprime(103423423423423423452345234);  
> rA:= p1*p2;                          # Первый открытый ключ
> alpha:= 4771231;                     # Закрытый ключ
> igcd(alpha,phi(rA));                 # Проверка выбора alpha
>   a:= alpha &^ (-1) mod phi(rA);
> # a:= alpha &^ (phi(phi(rA))-1) mod (phi(rA));     
>                                       # Второй открытый ключ
> # ----------------------------------------------------------
> # Получатель (Боб) генерирует случайное число r, (r,rA)=1
> # -------------------------------------------------------
> r:= 12234453436; print("Проверка: ", igcd(r,rA));
> # ------------------------------------------------------
> # Далее, Боб вычисляет m1 и посылает это значение Алисе:
> # -------------------------------------------------------
> m := 1234562342341232324 mod rA;     # Текст для подписи
> m1:= (m * r &^ a) mod rA;            # "Спрятанный" текст
> # --------------------------------------------------------
> # Отправитель (Алиса) подписывает m1 и возвращает
> # подписанное сообщение s1 Бобу
> # -----------------------------
> s1:= (m1 &^ alpha) mod rA;
> # --------------------------------------
> # Боб получает s1 и вычисляет значение s
> # --------------------------------------
> s:= (s1 * (r &^ (-1))) mod rA;
> # -------------------------------------------
> # Наконец, Боб проверяет подлинности подписи:
> # -------------------------------------------
> m2:= (s &^ a) mod rA; 
> print("Проверка: ", m-m2);
> #
