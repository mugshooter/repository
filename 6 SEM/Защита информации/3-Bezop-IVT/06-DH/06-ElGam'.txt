> # Реализация варианта алгоритма Эль-Гамаля, использующего
> # операцию "исключающее ИЛИ":
> # 
> #  (dA,p,g) - открытый ключ абонента A;
> #  (dB,p,g) - открытый ключ абонента B;
> #     cA    - закрытый ключ абонента A;
> #     cB    - закрытый ключ абонента B
> # 
> # **************
> with(numtheory);
> with(Bits):
> # -----------------------------------------------
> # Генерация открытых чисел p и g для коммуникации
> # ---------------------------------------------------------------
> p:=nextprime(2^1000); #(17498005798264095394980017816940970922825355447145699491406164851279623993595007385788105416184430877);
> # Количество битов в p:
> bitP:=length(1+floor(log[2](p)));
> #
> g:=primroot(2^50, p); # 4980057982640953976500178169262709228253554471452369503406164941279623993595307385078105416180853461;
> #
> # Количество битов в q:
> bitG:=length(1+floor(log[2](p)));   
> # ----------------------------------------------
> # Генерация  з а к р ы т о г о  ключа абонента A
> cA:=17498005798264095394980017816940970922825355447145699491406164851279623993595007385788105416184431367;
> # ---------------------------------------------------------------
> # Вычисление  о т к р ы т о г о  ключа абонента A
> dA:=g &^ cA mod p;
> # ----------------------------------------------
> # Генерация  з а к р ы т о г о  ключа абонента B
> cB:=4374501449566023848745004454235242730706338861786424872851541212819905998398751846447026354046454419;
> # ---------------------------------------------------------------
> # Вычисление  о т к р ы т о г о  ключа абонента B
> dB:=g &^ cB mod p;
> #
> # ----------------------------------------
> # Организация передачи информации: m -> m1
> # ---------------------------------------------------------------
> m:=312312312312312234234345746846784678467846784678467842342334523452345234523452345234523452345223412341234123412341234123412341 mod p;
> #
> # ------------------
> # Действия абонента A:
> cod:=Xor(m, g &^ (cB*cA) mod p);
> # ------------------------------------------------------------
> # Абонент B получает пару (dA,cod) и восстанавливает сообщение 
> m1:=Xor(cod, dA &^ cB mod p);
> # --------------------------
> # Проверка вычислений:
> res:=m-m1;
> 
