> # Реализация алгоритма Эль-Гамаля, используемого
> # для безопасной передачи сообщения:
> # 
> #  (dA,p,g) - открытый ключ абонента A;
> #  (dB,p,g) - открытый ключ абонента B;
> #     cA    - закрытый ключ абонента A;
> #     cB    - закрытый ключ абонента B
> # 
> # **************
> with(numtheory):
> # -----------------------------------------------
> # Генерация открытых чисел p и g для коммуникации
> # ---------------------------------------------------------------
> p:=17498005798264095394980017816940970922825355447145699491406164851279623993595007385788105416184430877;
>    
> g:=4980057982640953976500178169262709228253554471452369503406164941279623993595307385078105416180853461;
>    
> # ----------------------------------------------
> # Генерация  з а к р ы т о г о  ключа абонента A
> cA:=17498005798264095394980017816940970922825355447145699491406164851279623993595007385788105416184431367;
>      
> # -----------------------------------------------
> # Вычисление  о т к р ы т о г о  ключа абонента A
> dA:=g &^ cA mod p;
> # ----------------------------------------------
> # Генерация  з а к р ы т о г о  ключа абонента B
> cB:=4374501449566023848745004454235242730706338861786424872851541212819905998398751846447026354046454419;
>     
> # -----------------------------------------------
> # Вычисление  о т к р ы т о г о  ключа абонента B
> dB:=g &^ cB mod p;
> # ----------------------------------------
> # Организация передачи информации: m -> m1
> # ---------------------------------------------------------------
> m:=312312312312312234234345746846784678467846784678467842342334523452345234523452345234523452345223412341234123412341234123412341 mod p;
> # ---------------------------------------------------------------
> # Генерация абонентом A случайного числа k<p-1:
> k:=123342342342342342342342342344567891011123123123123123567567567567567567567567567567;
> r:=g &^ k mod p; 
> e:=m * dB &^ k mod p;
> # ------------------------------------
> # Восстановление сообщения абонентом B
> m1:=e * r &^ (p-1-cB) mod p;
> # --------------------------
> # Проверка вычислений:
> m-m1;
> 
   p:=1749800579826409539498001781694097092282535544714569949140616      4851279623993595007385788105416184430877   g:=4980057982640953976500178169262709228253554471452369503406164      941279623993595307385078105416180853461   cA:=174980057982640953949800178169409709228253554471456994914061       64851279623993595007385788105416184431367   dA:=170789877142049018903618232036482462987088886457062838343634       13940089769498071750446034632184657957036   cB:=437450144956602384874500445423524273070633886178642487285154       1212819905998398751846447026354046454419   dB:=944604399549048497189223923229867841845040905290562506187252       2661677845494058935332443487281531990777   m:=8814000859628675915565016966679572617908579024149516895066466      02176209138766501193287757284058404326   k:=1233423423423423423423423423445678910111231231231231235675675      67567567567567567567567   r:=1338650777706850148578209544489899945852392671978419056217346      1052098759926464525032515875458663363099   e:=1456804869749628279304736689049209038217259636054372657212055      9429135454939242045343883962100569664374   m1:=8814000859628675915565016966679572617908579024149516895066466       02176209138766501193287757284058404326                                      0
