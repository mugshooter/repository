> # Демонстрация криптографического протокола Шамира:
> #
> # (1) генерация ключей:
> #    p - открытый ключ,
> #    (cA,dA) - закрытыe ключи абонента A;
> #    (cB,dB) - закрытыe ключи абонента B;
> #
> # (2) передачи и приёма текста по методу Шамира
> # *********************************************
> with(numtheory):
> # ---------------------------------
> # Выбор  о т к р ы т о г о  ключа p
> # ("почти" автоматический)
> # -----------------------
> p:=nextprime(2342321231231231231231267856785678567856785678567856785678121234555555555555533388888657575123123123); 
> ifactor(p);    # Практически нереализуемая операция!
> #
> # ---------------------------------------------
> # Выбор  з а к р ы т о г о  ключа cA абонента A
> # ("почти" автоматический)
> # -----------------------------------------------------------
> cA:=nextprime(101231231000123123123234353464545675675675675); 
> igcd(cA,phi(p));    # Проверка выбора cA
> # -----------------------------------------------------
> # Выбор второго  з а к р ы т о г о  ключа dA абонента A
> # -----------------------------------------------------
> dA:=cA &^ (phi(p-1)-1) mod (p-1);
> # ---------------------------------------------
> # Выбор  з а к р ы т о г о  ключа cB абонента B
> # ("почти" автоматический)
> # -------------------------------------------------------------
> cB:=nextprime(12345123123452346312312315746856785785785755555); 
> igcd(cB,phi(p));    # Проверка выбора cB
> # -----------------------------------------------------
> # Выбор второго  з а к р ы т о г о  ключа dB абонента B
> # -----------------------------------------------------
> dB:=cB &^ (phi(p-1)-1) mod (p-1);
> # -------------------------------
> # Кодируемый текст, m<p 
> # --------------------
> m:=49687948681850449905704563564567456746333333333555555577777777777777777799999999 mod p;  
> # --------------------------------------------------------------
> # Процесс передачи и приёма текста
> # --------------------------------
> m1:=m  &^ cA mod p;
> m2:=m1 &^ cB mod p;  
> m3:=m2 &^ dA mod p;  
> m4:=m3 &^ dB mod p;  # Расшифрованный текст
> # ---------------------------------------------------------
> m-m4;                # Проверка результатов передачи текста
> 
   p:=2342321231231231231231267856785678567856785678567856785678121      234555555555555533388888657575123123227
   (234232123123123123123126785678567856785678567856785678567812123    4555555555555533388888657575123123227)
            cA:=101231231000123123123234353464545675675675689
                                      1
   dA:=185422805086188274519569664319383080342753493513236972673254       2426078630906107180338139947149593775011
            cB:=12345123123452346312312315746856785785785755617
                                      1
   dB:=232182594784896209110911844527046757136458703019701061573856       2804279314060287755844651168695921560169

   m:=4968794868185044990570456356456745674633333333355555557777777      7777777777799999999
   m1:=171176382086974152397969275079275450413502146385228176799653       0903339783807230607800111007696326166400
   m2:=124348453446161593547200251476520331146567372025805536482392       4390006121451038441937136341281569505244
   m3:=120700540456806180366138682272431505684581548983883161096079       9659273738644991868681673619096249424134
   m4:=496879486818504499057045635645674567463333333335555555777777       77777777777799999999
                                      0
