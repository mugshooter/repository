> # Реализуйте следующие протоколы с помощью  
> # системы символьных вычислений Maple:
> #
> # (1) подбрасывания монеты по телефону
> # 
> # Масолов Виссарион (4 курс, 04.12.2020)
> # ********************************************
> with(numtheory):
> # -----------------------------------------------------
> # Схема RSA
> # -----------------------------------------------------
> p1:=nextprime(10131223423452345234523452); 
> p2:=nextprime(1033123123234523452345234522345234);  
> M:=p1*p2;  
> #                                     
> d1:=12347; igcd(d1,phi(M));
> e:=d1 &^ (phi(phi(M))-1) mod (phi(M)); 
> # ------------------------------------------------------
> #  Функция y=f(x) для этого протокола:
> # ------------------------------------------------------
> p:=2 * rand() mod (M-1);           # Выбор чётного числа 
> f := (x) -> (x mod p) &^ e mod M; 
> # ------------------------------------------------------
> # (а) A выбирает  случайное значение x (подбрасывает 
> # монету),  зашифровывает x и полученное значение f(x) 
> # посылает B;
> # ------------------------------------------------------
> A:=rand(); fA:=f(A); 
> # ------------------------------------------------------
> # (б) B после получения значения f(x), пытается угадать 
> # чётность x и направляет свою догадку A;
> # ------------------------------------------------------
> B=rand() mod 2;
> # ------------------------------------------------------
> # (в) A, получив догадку от B, сообщает B, угадал  тот  
> # или нет, и направляет ему в подтверждение выбранный x;
> #
> # (г) B проверяет, не обманул ли его A, для чего он 
> # вычисляет f(x) и сравнивает (!) его с полученным от A 
> # на первом шаге.
> # ------------------------------------------------------
> fB:=f(A); 
> printf("Результат: %d",fB-fA); 
                p1 := 10131223423452345234523609
            p2 := 1033123123234523452345234522345309
M := 10466801185423847844114148188576309984126909931418010900181
                          d1 := 12347
                               1
e := 4185194577827612926734554507691935933015487852819264611027
                       p := 730882231556
             f := x -> `mod`((`mod`(x, p)) &^ e, M)
                       A := 713383589673
fA := 3444680074523807466231190071861335263080387911280283261616
                             B = 0
fB := 3444680074523807466231190071861335263080387911280283261616
Результат: 0
;
> 
;
