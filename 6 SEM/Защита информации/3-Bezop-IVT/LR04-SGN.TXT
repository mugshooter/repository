    2УПРАЖНЕНИЕ 4.
    2АСИММЕТРИЧНАЯ КРИПТОГРАФИЯ: протоколы электронной подписи и про-
 2токолы аутентификации на базе RSA

 ш1.0
                        1Главное - это из множества  проблем  выбрать
                        1наиболее  простые,  решение которых позволит
                        1выработать концепции, допускающие обобщения.
                                                          1Д.Гильберт
 ш1.2

                  2ОБЯЗАТЕЛЬНЫЕ РЕЗУЛЬТАТЫ ОБУЧЕНИЯ
    _ 1Предварительные понятия . 0:
 ш1.0
    1- криптосистема с открытым ключом  0( 1асимметричная криптосистема 0);
    1- криптографический протокол 0;
    1- однонаправленная функция 0;
    1- односторонняя функция с "лазейкой" 0.

 ш1.2
    _ 1Основные понятия . 0:
 ш1.0
   -  1электронная подпись RSA без секретной передачи сообщения 0;
    1- электронная подпись RSA  без  2  1секретной 0  2  1передачи сообщения  0( 1с
 1хэшированием 0);
   -  1электронная подпись RSA совместно с секретной передачей  сооб-
 1щения 0;
    1- 0  1аутентификация 0:  1протокол аутентификации 0.

    _ 1Уметь реализовать протоколы . 0:
    1- электронной подписи RSA без секретной передачи сообщения 0;
    1- электронной подписи RSA 0  1без секретной  передачи  сообщения   0( 1с
 1хэшированием 0);
    1- электронной подписи RSA совместно с секретной передачей  сооб-
 1щения 0;
    1- аутентификации 0;
    1- электронная подпись "вслепую" 0.
 ш1.2

                       2ТЕОРЕТИЧЕСКИЕ СВЕДЕНИЯ

 ш1.0
                           1Если видишь салат и приправу, сразу ясно,
                           1какое готовится блюдо.
                              1А.Конан Дойл. Подвиги бригадира Жерара
 ш1.2

                          3Основные понятия
   С развитием электронной почты с компьютера  на  компьютер  стало
поступать огромное количество посланий самого разного свойства.
   Среди личных посланий, поздравлений, рекламных проспектов и про-
чего в электронной почте стали попадаться и  _ 1документы . 0.
   Напомним, что  обычный текст превращаются в документ,  когда под
ними появляется  _ 1подпись . 0,  и к этому нас приучил  многовековой  опыт
"бумажного" обращения с текстами.
   Более того, даже один и тот же текст может иметь совершенно раз-
ный смысл в зависимости от того,  кто его подписал. Одно дело, если
текст подписал  министр,  и  совсем другое дело,  если тот же самый
текст подписал третий секретарь четвёртого отдела министерства.
   Однако если  имеется подпись,  то имеется и проблема борьбы с её
подделкой, а  переход  к электронным документам эту проблему только
обострил.  Поскольку, например, передача по сети сканированного до-
кумента,  снабжённого ручной подписью,  проблемы подделки ни в коем
случае не решает, а для любой серьёзной экспертизы подлинности под-
писи требуется оригинал "бумажного" документа.
   Так возникла задача создания  1электронной цифровой подписи 0.
    2Определение 0.
 ш1.1
    _ 1Электронной цифровой подписью . 0 ( 1ЭЦП 0) называется  реквизит  элект-
ронного документа, появление которого в документе получателем подт-
верждает два факта:
   (1) документ поступил к получателю без искажений;
   (2) документ подписан именно отправителем.

 ш1.2
   Термин " 1электронная подпись 0" более привычен для России,  хотя  в
последнее время  всё  чаще  используется  принятый в других странах
(прежде всего в США) термин " 1цифровая подпись 0",  что отражено в но-
вых российских стандартах.
   Другими словами, эти термины являются синонимами.
   Ниже будем различать следующие  _ 1типы подписей . 0:
 ш1.1
   -  1рукописная личная подпись 0;
   -  1рукописная  нотариальная подпись 0,  когда специально выделяемое
лицо (нотариус) заверяет документы своей подписью  и  печатью,  так
что любое другое лицо может удостовериться в их подлинности;
   -  1электронная 0 (личная)  1подпись 0;
   -  1электронная нотариальная подпись 0 ( 1сертифицированная  подпись 0) 1,
которая  является аналогом в информационном пространстве рукописной
нотариальной подписи.

 ш1.2
   Сформулируем  _ 1свойства . 0, которым (в идеале)  должна  удовлетворять
подпись любого выделенного типа:
 ш1.1
   (1) подписать  документ может только "законный" владелец подписи,
т.е. никто не может подделать подпись;
   (2) автор подписи не может от неё отказаться;
   (3) в  случае  возникновения  спора возможно участие  1третьих лиц
(либо людей,  либо информационных систем) для установления  подлин-
ности подписи.

 ш1.2
   Разумеется, цифровая (электронная) подпись также должна обладать
всеми этими свойствами, однако лица, подписывающие документы и про-
веряющие их  подлинность могут находиться за тысячи километров друг
от друга и взаимодействовать только через компьютерную сеть.
    3Замечания 0 ( 1важные 0).
 ш1.1
    21. 0 На практике  1цифровой сертификат 0, содержащий цифровую подпись,
выпускается   _ 1сертифицирующим  органом . 0,  устанавливающим связь между
 1открытым ключом 0 и личностью пользователя.
    22. 0 Нотариальная подпись может также являться цифровой подписью.

 ш1.2
   Общепризнанная  _ 1схема . 0  ( 1модель 0)  _ 1цифровой подписи . 0 содержит три ал-
горитмических процесса:
 ш1.1
   (1) генерация ключей (подписи и проверки);
   (2) формирование подписи;
   (3) проверка подписи.
 ш1.2

                   2Электронная подпись на базе RSA

 ш1.0
                     1- А  когда  компьютер  уже проанализировал ДНК,
                     1как вы определяете,  какому животному принадле-
                     1жит генетический материал 0? 1...
                     1- Можно просто вырастить  животное  и  опознать
                     1его по внешним признакам, - сказал он. - Обычно
                     1мы так поступаем.
                                     1М.Крайтон. Парк юрского периода
 ш1.2

                   21. 3 Электронная подпись RSA 0  3без
                    3секретной 0  3передачи сообщения
   Рассмотрим протокол формирования электронной  цифровой  подписи,
основанный на алгоритме RSA.
   В обмене участвуют отправитель A и получатель B.
   Пусть A отправляет B текст x и желает,  чтобы это сообщение было
снабжено электронной цифровой подписью.
    _ 1Протокол . 0, решающий указанную задачу, состоит из  следующих шагов
[Музыкантский,Фурин,2011,с.32]:
 ш1.1
   (а) A строит стандартную схему RSA; пусть её  1открытый ключ 0 (m, 3e 0)
и  1закрытый ключ 0 (m, 3d 0);  как всегда, открытый ключ публикуется, зак-
рытый остаётся известен только A;
   (б) если x - отправляемый текст, то A вычисляет с помощью  _ 1закры-
 _ 1того ключа . 0 число s по формуле
 ш1.0

   s= x 5d 1 mod 0 m

 ш1.1
и отправляет  получателю  B текст x и число s в качестве его элект-
ронной цифровой подписи, т.е. пару (x,s);
   (в) абонент B, получив пару (x,s), выбирает число s, берёт опуб-
ликованный открытый ключ A и вычисляет число
 ш1.0

   x'= s 5e 1 mod 0 m.

 ш1.1
   Теперь если x'=x, то подпись правильна, что означает, что исход-
ный текст (действительно подписанный A) принят без искажений.
   Если же x' 7- 0x, то это означает, что либо в исходный текст внесены
изменения, либо он подписан не отправителем A, либо и то, и  другое
выполнено совместно.

 ш1.2
   Смысл указанного протокола в том,  что абонент B (как и в случае
протокола аутентификации) убеждается,  что подпись s, полученная им
вместе с исходным текстом x, вычислялась с использованием закрытого
ключа (m, 3d 0), "парного" к открытому ключу отправителя.
   Такую операцию мог проделать только сам отправитель A, поскольку
только он знает закрытый ключ.
 ш1.0

    4┌ 0─────────────────────────────────────────────────────────── 4┐
   │ _ 1Внимание . 0! Получатель не получает никакой информации о самом│
   │          закрытом ключе отправителя, т.е. в этом протоколе│
   │          работает  _ 1схема нулевого разглашения . 0.             │
    4└ 0─────────────────────────────────────────────────────────── 4┘

 ш1.2
   Схема электронной цифровой подписи имеет дополнительно следующие
важные  _ 1свойства . 0:
 ш1.1
   (1) данная конкретная подпись может относиться только  к  одному
конкретному тексту.
   Действительно, если  отправитель  A  попытается подобрать другой
текст x' так,  чтобы он имел ту же подпись, что и исходный текст x,
то ему придётся найти новый текст x' из уравнения
 ш1.0

   (x') 5d 1 mod 0 m= x 5d 1 mod 0 m,

 ш1.1
а такое  уравнение (по крайней мере,  в классе осмысленных текстов)
может иметь только одно решение.
   Это обстоятельство определяет важнейшее свойство цифровой подпи-
си  - 1 невозможность отправителя подменить подписанный им текст либо
 1отказаться от подписи 0.
   Это свойство, называемое  _ 1неотказуемостью . 0 ( _ 1неотвергаемостью . 0)  _ 1под-
 _ 1писи . 0,  ставит  в жёсткие рамки отправителя сообщения,  в тоже время
получатель застрахован от возможных последствий  недобросовестности
отправителя;
   (2) отправитель может быть уверен, что его цифровую подпись ник-
то не может подделать, поскольку закрытый ключ знает только он сам.

 ш1.2
   Эти два обстоятельства делают тексты, подписанные с помощью циф-
ровой подписи,  _ 1юридически значимыми . 0, т.е. они могут служить основой
сделок, контрактов, могут приниматься в судах в качестве веществен-
ных доказательств и,  вообще, могут признаваться там, тогда и в той
степени,  где, когда и в какой степени могут признаваться собствен-
норучные  1личные подписи 0.
                   22. 3 Электронная подпись RSA 0  3без
                    3секретной 0  3передачи сообщения
                          2( 1с хэшированием 2)
   Если Алиса планирует подписовать документы, то она должна внача-
ле выбрать параметры RSA:
 ш1.1
   (1) Алиса выбирает два больших простых числа P, Q и вычисляет
 ш1.0

   N= P 77 0Q, 7 f 0(N)= (P-1) 77 0(Q-1);

 ш1.1
   (2) она выбирает число 3 d 0, взаимно простое с  7f 0(N), и вычисляет
 ш1.0

    3e 0=  3d 5-1 1 mod 0  7f 0(N).

 ш1.1
   (3) она публикует числа N и 3 d 0,  например, помещает их своём сай-
те, связанном со своим именем, и хранит в секрете число 3 e 0.

 ш1.2
   Теперь Алиса готова ставить свои подписи на документах или сооб-
щениях.
   Пусть Алиса хочет подписать сообщение 3 m 0  ═+ 0 m 41 0m 42 0...m 4n 0.
   Опишем  _ 1протокол электронной подписи . 0 [Рябко,Фионов,2018,с.52-53]:
   Вначале Алиса вычисляет значение  _ 1хэш-функции . 0 (?!)
 ш1.0

   y  ═+ 0  1h 0(m 41 0,m 42 0,...,m 4n 0),

которая ставит в соответствие сообщению  3m 0 число y.

    4┌ 0─────────────────────────────────────────────────── 4┐
   │Пусть алгоритм вычисления хэш-функции известен всем│.
    4└ 0─────────────────────────────────────────────────── 4┘

 ш1.2
   Отметим здесь только наиболее важное для нас  свойство:  практи-
чески невозможно изменить текст сообщения  3m 0, не изменив при этом y.
   Поэтому на следующем шаге  Алисе  достаточно  снабдить  подписью
только число y, и подпись будет относиться ко всему сообщению 3 m 0.
   Алиса вычисляет число
 ш1.0

   s= y 5e 1 mod 0 N,

 ш1.2
т.е. она возводит число y в свою "секретную степень".
   Число s и есть  _ 1цифровая подпись . 0,  которая просто  добавляется  к
сообщению 3 m 0, и этим Алиса формирует  1подписанное сообщение 0 ( 3m 0,s).
   Теперь каждый,  кто знает открытые параметры Алисы,  связанные с
её именем, т.е. числа N и  3d 0, может проверить подлинность её подписи.
   Для этого необходимо, взяв подписанное сообщение ( 3m 0,s):
 ш1.1
   - вычислить значение хэш-функции  1h 0( 3m 0);
   - вычислить w=s 5d 1 mod 0 N;
   - проверить выполнение равенства w= 1h 0( 3m 0).

 ш1.2
    2Теорема 0 [Рябко,Фионов,2018,с.53].
 ш1.1
   Если подпись подлинная, то w= 1h 0( 3m 0).

 ш1.2
    2Доказательство 0. Выполним простые вычисления:
 ш1.0

   w= s 5d 1 mod 0 N= (y 5e 1 mod 0 N) 5d 1 mod 0 N= y 5ed 1 mod 0 N= y  ═+ 0  1h 0( 3m 0).

 ш1.2
    1Теорема доказана 0.
    2Теорема 0 [Рябко,Фионов,2018,с.53].
 ш1.1
   Описанная электронная  подпись  удовлетворяет  всем требованиям,
предъявляемым к подписи.

 ш1.2
    2Доказательство 0. Последовательно проверим все свойства подписи:
   (1) никто не может разложить число N на простые  множители  (при
больших N  порядка  1024  битов  _ 1по состоянию на . 2010 0 (!) эта задача
практически неразрешима). Поэтому, зная N 3  0и  3d 0 невозможно найти 3 e 0.
   Действительно, чтобы вычислить 3 e 0= 3d 5-1 1 mod 7 f 0(N), нужно знать  7f 0(N),
а для этого нужно знать простые множители P и Q.
   Итак, никто,  кроме  Алисы,  не может знать число 3 e 0 и поэтому не
может подписать сообщение.
   (2) автор подписи не может от неё отказаться,  т.к. никто другой
не может "сфабриковать" подпись от её имени.
   (3) в  случае  спора  заинтересованная  сторона может предъявить
судье все вычисления для их проверки и выяснения истины.
    1Теорема доказана 0.
    2Пример 0 [Рябко,Фионов,2018,с.53-54].
 ш1.1
   Пусть P=5, Q=11. Тогда N=5 77 011=55, 7 f 0(N)=4 77 010=40.
   Пусть 3 d 0=3. Такой выбор 3 d 0 возможен, т.к. 1 gcd 0(40,3)=1.
   Параметр  3e 0=3 5-1 1 mod 0 40 вычисляем с помощью  1обобщённого  алгоритма
 1Евклида 0,  3e 0=27.
   Пусть Алиса хочет подписать сообщение 3 m 0  ═+ 0 "abbbaa", для которого
значение хэш-функции равно, например, 13, т.е.
 ш1.0

    1h 0( 3m 0)  ═+ 0 13.                  1         0    ║ 1 Это лишь предположение 0!

 ш1.1
   Далее, Алиса  вычисляет  s=13 527 1 mod 0 55=7 и формирует подписанное
сообщение ("abbbaa",7).
   Теперь знающий открытые ключи Алисы N=55 и 3 d 0=3  может  проверить
подлинность подписи следующим образом:
 ш1.1
   - получив подписанное сообщение, он вычисляет значение хэш-функ-
ции  1h 0("abbbaa")=13 (если содержание сообщения не изменено,  то зна-
чение хэш-функции совпадёт с тем, которое ранее вычислила Алиса);
   - далее, он вычисляет w=7 53 1 mod 0 55=13 и определяет выполнение ра-
венства  1h 0("abbbaa")=w, т.е. что подпись верна.
 ш1.2

                       23. 3 RSA-схема шифрования
                              3и подписи

 ш1.0
                    1- По-моему,  мы  не  то  делаем,  - сказал вдруг
                    1Бильбо,  доставая из кармана огромный ключ   0( 1...
                    1для тролля это наверняка был не ключ, а ключик 0) 1.
                    1- Я нашел его у костра. Наверно, выпал у кого-то
                    1из кармана.
                    1- Что же ты молчал 0? 1 - закричали все хором.
                    1Гэндальф схватил ключ и вставил в замочную сква-
                    1жину. Ключ повернулся, гномы вновь навалились на
                    1плиту, и та отошла в сторону. 0
                              1Дж. Толкин. Хоббит, или Туда и Обратно
 ш1.2

   Существует способ передачи аутентифицированного сообщения от A к
B способом, который называется  _ 1подписать и зашифровать . 0:
 ш1.1
   (1) абонент A ставит на данные цифровую подпись с помощью закры-
того ключа;
   (2) абонент A присоединяет подпись к данным;
   (3) абонент A шифрует данные и подпись с помощью открытого ключа
абонента B;
   (4) абонент B расшифровывает данные и подпись с  помощью  своего
закрытого ключа;
   (5) абонент B расшифровывает данные и подпись с помощью открыто-
го ключа абонента A,  т.е. B уверен, что сообщение пришло именно от
абонента A.

 ш1.2
   Пусть Алиса  хочет  подписать  сообщение m Бобу;  при этом Алиса
сначала подписывает m с помощью своего секретного  ключа,  а  затем
шифрует результат с помощью открытого ключа Боба.
   Тем не менее, этот алгоритм  _ 1не всегда применим . 0 в системе RSA.
   Пусть ключами Алисы являются (n 4A 0, 3e 4A 0), 3  d 4A 0, а Боба - (n 4B 0, 3e 4B 0), 3 d 4B 0;
при этом важно, что
 ш1.0

   n 4A 0 < n 4B 0-1.

 ш1.2
   Протокол описывается следующим образом:
 ш1.0
                                4┌ 0  3d 4A 0       4┐ 3e 4B
   (1) Алиса посылает Бобу: C 7= 0 │m  4  0mod n 4A 0│  4  0(mod n 4B 0);
                                4└ 0          4┘
                                      4┌ 0  3d 4B 0       4┐ 3e 4A
   (2) Боб восстанавливает m так: m 7= 0 │C  mod n 4B 0│  (mod n 4A 0).
                                      4└ 0          4┘

 ш1.2
   Однако возникает новая проблема,  а именно: что делать, если Боб
захочет подписать конфиденциальное сообщение Алисе?
   Простое решение состоит в том,  чтобы каждый пользователь созда-
вал два набора параметров: один с модулем, меньшим некоторого поро-
га T 7е ═N 0, а другой - с модулем большим T. В этих условиях отправитель
использует свой  собственный  меньший  модуль для подписи и б 3о 0льший
модуль получателя - для шифрования.
   Если между Алисой и Бобом возникает спор, то они идут к арбитру,
который получает от Боба числа
 ш1.0

         3d 4B 0 mod n 4B
   u  ═+ 0 C          и m.

   Легко видеть, что

       4┌┌ 0  3d 4A 0       4┐ 3e 4B 0       4┐ 3d 4B 0    3d 4A
   u= ││m  mod n 4A 0│  mod n 4B 0│  = m  mod n 4A 0.
       4└└ 0          4┘ 0         4┘

 ш1.2
   Если теперь u 5e 4A 7= 0m, то сообщение m действительно пришло от Алисы;
если же нет,  то u не будет рассматриваться как подпись Алисы к со-
общению m.
   Заметим, что арбитр не нуждается в знании закрытых ключей  Алисы
или Боба. Поэтому Алиса и Боб могут продолжать использовать эти па-
раметры.
    2Пример 1 0 [Романьков,2012,с.155-156].
 ш1.1
   Пусть
 ш1.0

   n 4A 0= 8387 77 07499= 62894113, 3 e 4A 0= 5, 3 d 4A 0= 37726937, n 4B 0=55465219,
                             3e 4B 0= 5, 3 d 4B 0= 44360237, m= 1368797.
   Тогда Алиса вычисляет:
        3d 4A 3                        e 4B
   S 7= 0 m  (mod n 4A 0)= 59847900, C 7= 0 S  (mod n 4B 0)= 38842235.

   Теперь Боб проверяет правильность подписи:
         3d 4B 3                         e 4A
   S 41 7= 0 C  (mod n 4B 0)= 4382681, m 41 7= 0 S 41 0  (mod n 4A 0)= 54383568.

 ш1.1
   Обнаруживается, что m 7- 0m 41 0,  хотя все действия выполнялись по про-
токолу. Причиной этого является то, что n 4A 0>n 4B 0.

 ш1.2
    2Пример 2 0.
 ш1.1
   Если n 4A 0>n 4B 0+1, то рассмотрим сообщение
 ш1.0
              3e 4A
   m  ═+ 0 (1+n 4B 0)  .

   Тогда Алиса посылает:

       4┌┌ 0     4┐ 3e 4A 3d 4A 0       4┐ 3e 4B 0           4┌┌ 0     4┐ 0        4┐ 3e 4B
   C 7= 0 ││1+n 4B 0│    mod n 4A 0│  (mod n 4B 0)= ││1+n 4B 0│ mod n 4A 0│  ,
       4└└ 0     4┘ 0           4┘ 0             4└└ 0     4┘ 0        4┘
а Боб пытается восстановить сообщение:

        4┌┌┌ 0     4┐ 0        4┐ 3e 4B 3d 4B 0       4┐ 3e 4A
   m 41 7= 0 │││1+n 4B 0│ mod n 4A 0│    mod n 4B 0│  mod n 4A 7= 0 1,
        4└└└ 0     4┘ 0        4┘ 0           4┘

т.е. m 7- 0m 41 0, и Алиса своей подписью изменила текст.

 ш1.2
                    24. 0  3Протокол подписи 0  3"вслепую"
                     ( 1первый вариант описания 0)
   Рассмотрим протокол, который называется  _ 1подпись "вслепую" . 0 (англ.
 1blind signature 0).
   При использовании этой криптографической схемы отправитель, под-
писывающий сообщение,  _ 1не знает . 0 содержания сообщения.
   Пусть, следуя схеме RSA, найдены:
 ш1.1
    3d 0     -  закрытый ключ создания подписи,
   (n, 3e 0) - открытый ключ проверки подписи.

 ш1.2
   Обозначим m - сообщение,  для которого необходимо получить  под-
пись, не раскрывая его содержания, а в создании подписи участвуют и
отправитель, подписывающий сообщение, и получатель этого сообщения.
   Получатель генерирует  случайное число r такое,  что (r,n)=1,  и
посылает отправителю вычисленное с помощью открытого ключа значение
 ш1.0

   m' 7= 0 r 5e 77 0m ( 1mod 0 n).

 ш1.2
   Очевидно, что содержание сообщения m "скрыто" числом r.
   Отправитель возвращает  подписанное сообщение (он обязан это вы-
полнить по условию):
 ш1.0
                                         ═о 5?
   s' 7= 2  0(r 5e 77 0m) 5d 0 ( 1mod 0 n) 7= 2  0r 5ed 77 0m 5d 0 ( 1mod 0 n) 7= 0 r 77 0m 5d 0 ( 1mod 0 n).

 ш1.2
   В самом деле, вспомним, что
 ш1.0

    3d 77 3e 7= 0 1 ( 1mod 0  7f 0(n)) =>  3d 77 3e 0= 1 + k 77f 0(n), k 7е ═Z 0,

а по построению схемы (r,n)=1; тогда по  1теореме Эйлера

         1+k 77f 0(n)  2  0  4┌ 0  7f 0(n) 4┐ 0k
   r 5ed 7= 2  0r         7= 2  0r 72 0r     72 0  7= 2  0r 77 01 ( 1mod 0 n).
                     4└ 0      4┘

 ш1.2
   Получатель вычисляет значение
 ш1.0

   s 7= 2  0s'r 5-1 0 ( 1mod 0 n) 7= 2  0(rm 5d 0) 77 0r 5-1 0 ( 1mod 0 n) 7= 2  0(rr 5-1 0) 77 0m 5d 0 ( 1mod 0 n) 7=

     7= 0 m 5d 0 ( 1mod 0 n),

 ш1.2
которое и является значением подписи.
   Подпись считается подлинной, если выполнено сравнение
 ш1.0

   s 5e 7= 0 m ( 1mod 0 n).

 ш1.2
   В самом деле,
 ш1.0

   s 7= 2  0m 5d 0 ( 1mod 0 n) => s 5e 7= 2  0m 5de 0 ( 1mod 0 n) 7= 2  0m ( 1mod 0 n).

 ш1.2
                   24 41 2. 0  3Протокол подписи 0  3"вслепую"
                     ( 1второй вариант описания 0)
   При использовании этой схемы  1отправитель 0 (Алиса),  подписывающий
сообщение, не знает содержания этого сообщения.
   Пусть 3 d 0 - закрытый ключ создания подписи Алисы, (n, 3e 0) - открытый
ключ проверки подписи Алисы.
   Приведём  _ 1протокол подписи . 0 " _ 1вслепую . 0",  если получателем подписан-
ного сообщения является Боб:
   (а) Боб случайным образом генерирует число r такое,  что (r,n)=1
и посылает Алисе значение
 ш1.0

   m' 7= 0 r 5e 77 0m (mod n),

 ш1.2
при этом содержание сообщения m "скрыто" числом r;
   (б) Алиса подписывает m':
 ш1.0

   S' 7= 0 (m') 5d 0 (mod n)

 ш1.2
и возвращает подписанное Бобу;
   (в) Боб получает S' и вычисляет:
 ш1.0

   S 7= 0 S' 77 0r 5-1 0 (mod n) 7= 0 (m') 5d 77 0r 5-1 0 (mod n) 7= 0 (r 5e 77 0m) 5d 77 0r 5-1 0 (mod n) 7=

                     7= 0 r 5ed 77 0m 5d 77 0r 5-1 0 (mod n) 7= 0 m 5d 0 (mod n)

 ш1.2
(в результате получена подпись Алисы);
   (г) Боб проверяет подпись Алисы,  установив выполнимость сравне-
ния m 7= 0 S 5e 0 (mod n), т.е. "сняв" подпись Алисы с сообщения.

                           2Аутентификация
                     21. 3 Протокол аутентификации

 ш1.0
                          1Между домами устроены магнетические телег-
                          1рафы, посредством которых живущие на далё-
                          1ком расстоянии общаются друг с другом. 0
                                           1В.Ф.Одоевский. 4338-й год
 ш1.2

   Базы данных  компьютеров  хранят огромное количество информации.
Часть её общедоступна и с ней может ознакомиться любой желающий.
   Однако кроме общедоступной информации в базах данных может также
храниться информация,  представляющая служебную,  коммерческую  или
государственную тайну. Ясно, что эта информация не может быть обще-
доступной, она является закрытой.
   Но также  ясно,  что  если закрытая информация имеется,  значит,
кто-то должен иметь к ней доступ, даже к самой секретной.
    2Определение 0.
 ш1.1
    _ 1Разграничением доступа . 0  называется процесс разделения всех поль-
зователей на категории в зависимости от вида доступной информации.

 ш1.2
   К этому  понятию  относят  также  и способ обработки информации,
доступный тому или иному пользователю - одному пользователю  разре-
шается один  фрагмент  информации только читать,  а другой фрагмент
ещё и изменять,  либо совсем уничтожать, либо создавать новый фраг-
мент информации. А другой пользователь может всю информацию исполь-
зовать только в режиме чтения.
   Короче говоря,  концепция  разграничения доступа предусматривает
следующее  _ 1условие . 0:  прежде чем допустить какого-либо пользователя к
информации, необходимо определить его полномочия, а для этого нужно
сначала этого пользователя  1идентифицировать 0.
    2Определение 0.
 ш1.1
    2(1) 0  _ 1Идентификация . 0  -  это процесс установления личности человека
или идентичности юридического лица.
    1Идентификация 0 базируется на одном из следующих признаков или  их
комбинации:
   - предъявлении документа (например, магнитной карты, смарткарты,
паспорта);
   - знании определённого "текста" (например,  пароля, PIN, секрет-
ного ключа)
   - проверке  индивидуальных  особенностей  (например,  отпечатков
пальцев, подписи, голоса, структуры сетчатки глаза, ДНК и т.п.);
   - демонстрации  определённых  умений (например,  умение доказать
некоторый математический результат).
    2(2) 0 [Словарь,2006]   _ 1Идентификация . 0  -  это процедура установления
присвоенного данной стороне уникального системного имени -   1иденти-
 1фикатора 0, которое позволяет отличать её от других сторон.
   Обычно процедура идентификации заключается в предъявлении  этого
имени и предшествует процедуре  _ 1аутентификации . 0,  т.е.  подтверждению
правильности идентификации.
   Термин " 1идентификация 0"  часто для краткости используют для обоз-
начения общей процедуры идентификации/аутентификации сторон.

 ш1.2
    2Определение 0.
 ш1.1
    2(1) 0  _ 1Аутентификацией . 0 называется криптографический  1процесс иденти-
 1фикации пользователя 0,  защищающий информационную систему от несанк-
ционированного доступа.
    2(2) 0  _ 1Аутентификацией . 0 называется процедура, с помощью которой про-
веряющий  устанавливает законность  1идентификации 0 пользователя в ин-
формационной системе.
   Результатом аутентификации является принятие или отклонение пос-
тупившего от пользователя требования.
   Другими словами,  пользователь  должен  доказать  свою правомоч-
ность, а проверяющий - проверить правильность доказательства.

 ш1.2
    3Замечания 0 ( 1важные 0).
 ш1.1
    21. 0 Процессы идентификации и аутентификации различны ( 1почему 0?).
    22. 0 Существует связь протокола аутентификации с протоколом цифро-
вой подписи, однако главным отличием является то, что цифровая под-
пись, как правило, не связана с реальным временем.

 ш1.2
   Рассмотрим  _ 1протокол аутентификации . 0, который основан на алгоритме
RSA [Музыкантский,Фурин,2011,с.30] и в котором участвуют два  поль-
зователя:  A - пользователь,  пытающийся пройти аутентификацию, B -
проверяющий.
   Протокол состоит из следующих шагов:
 ш1.1
   (а) проверяемый A строит стандартную схему RSA;  пусть её  1откры-
 1тый ключ 0  (m, 3e 0)  и   1закрытый ключ 0 (m, 3d 0) (естественно,  что открытый
ключ публикуется, а закрытый остаётся известен только A);
   (б) проверяющий B посылает проверяемому A случайную строку s;
   (в) проверяемый A вычисляет с помощью известного  ему  закрытого
ключа  3d 0 число g по формуле
 ш1.0

   g= s 5d 1 mod 0 m

 ш1.1
и отправляет полученное число g проверяющему B;
   (г) проверяющий B, получив число g, выбирает из публикации  отк-
рытый ключ абонента A и вычисляет его с помощью число
 ш1.0

   s'= g 5e 1 mod 0 m.

 ш1.1
   Если при этом s'=s,  то аутентификация  1принята 0, если же s' 7- 0s, то
аутентификация  1отвергнута 0.

 ш1.2
   Смысл указанного протокола в том, что проверяющий B убеждается в
том, что абонент, проходящий процедуру аутентификации, действитель-
но знает закрытый ключ системы RSA,  "парный" открытому ключу  або-
нента A, а значит, он является тем самым проверяемым A.
   Любой другой абонент,  пытающийся выдать себя за  абонента  A  с
целью получить  его полномочия по доступу к информационной системе,
должен для успешного прохождения процедуры идентификации:
 ш1.1
   (1) либо взломать схему RSA,  построенную абонентом A, что прак-
тически невозможно при условии грамотного построения абонентом схе-
мы RSA;
   (2) либо просто украсть у A его закрытый ключ  3d 0, что практически
невозможно при условии грамотного  соблюдения  абонентом  A  правил
хранения секретной информации.

 ш1.2
   Выполнение обоих этих условий возлагается на  абонента  A,  пос-
кольку это целиком в его интересах.
 ш1.0

    4┌ 0───────────────────────────────────────────────────────────── 4┐
   │ _ 1Внимание . 0. При использовании указанного протокола аутентифика-│
   │          ции закрытый ключ  3d 0 пользователя A не раскрывался. │
    4└ 0───────────────────────────────────────────────────────────── 4┘

 ш1.2
   Отметим, что выше мы рассмотрели только простейший случай прото-
кола аутентификации. Для подтверждения наших слов приведём
    2Определение 0 [Словарь,2006] ( 1важное 0).
 ш1.1
    2(1) 0  _ 1Протокол аутентификации сообщения . 0  -  это  криптографический
протокол, предназначенный для обеспеченности целостности сообщений,
под которым понимается гарантируемая получателю возможность удосто-
вериться,  что  сообщение  поступило от заявленного отправителя и в
неискажённом виде.
   В случае,  когда участники протокола доверяют друг другу и защи-
щаются от противника, протоколы аутентификации  сообщений  строятся
на основе  _ 1кодов аутентичности сообщений . 0.
   Если же участники друг другу не доверяют,  то для аутентификации
сообщений используется  _ 1схема цифровой подписи . 0.
    2(2) 0  _ 1Код аутентичности сообщения . 0 (синоним:   1имитовставка 0)  -  это
специальный набор  символов в протоколах аутентификации сообщений с
доверяющими друг другу участниками, добавляемый к сообщению и пред-
назначенный для обеспечения его целостности и аутентификации источ-
ника данных.
    2(3) 0  _ 1Протокол идентификации . 0 - это протокол аутентификации сторон,
участвующих во взаимодействии и не доверяющих друг другу.
   Различают протоколы идентификации:
   (а)  1с односторонней аутентификацией 0;
   (б)  1со взаимной аутентификацией 0.
   Протоколы идентификации, как правило, основаны на известной обе-
им сторонам  информации  (пароли,  личные идентификационные номера,
секретные ключи,  открытые ключи) и  реализуются  с  использованием
техники "запрос-ответ" или  1доказательства с нулевым разглашением 0.
   В дополнении к протоколу идентификации могут использоваться  не-
которые физические приборы,  с помощью которых проводится идентифи-
кация (магнитная или интеллектуальная  пластиковая  карта,  прибор,
генерирующий меняющиеся со временем пароли), а также биометрические
параметры.

 ш1.2
    3Замечания 0 ( 1для знатоков 0).
 ш1.1
    21. 0 Различают   _ 1слабую . 0  (пароли,  личные  идентификационные номера
(PIN)) и  _ 1сильную . 0 аутентификацию.
    22. 0 Протокол  аутентификации  иллюстрирует одно из важных понятий
математической криптографии -  1доказательство с нулевым  разглашени-
 1ем 0.
 ш1.2

                  22. 0  3Закрытый информационный обмен
                       3между двумя абонентами

 ш1.0
                   1Не будь дураком 0! 1 Будь тем, чем другие не были.
                   1Не выходи из комнаты 0! 1 То есть, дай волю мебели,
                   1слейся лицом с обоями. Запрись и забаррикадируйся
                   1шкафом от хроноса, космоса, эроса, расы, вируса.
                          1И.Бродский. Не выходи из комнаты... 0 ( 11970 0)
 ш1.2

   Криптографические протоколы,  часть которых приведена в предыду-
щем разделе, позволили найти решение многих новых задач, в том чис-
ле и тех,  которые раньше вообще считались неразрешимыми (например,
 1задача о подбрасывании монеты по телефону 0).
   Более того,  криптографические протоколы стали основой  развития
многих новых  направлений информатики,  из которых следует в первую
очередь отметить  1информационную безопасность 0.
   Однако сами  по  себе криптографические протоколы только предос-
тавляют математическую основу решения проблемы.  Они вполне  доста-
точны для  организации защищённого компьютерного обмена между двумя
абонентами.
   Пусть, например,  два абонента хотят наладить между собой компь-
ютерный обмен так, чтобы гарантировать его конфиденциальность, даже
в случае вторжения активных противников.
   Криптографические протоколы  предоставляют  для решения подобной
задачи разнообразные  _ 1инструменты . 0, в частности, они могут (по [Музы-
кантский,Фурин,2011,с.42-43]):
 ш1.1
   (1) договориться об использовании в процессе обмена взаимную  _ 1ау-
 _ 1тентификацию . 0;
   (2)  _ 1шифровать . 0 свои послания;
   (3) договориться  об использовании в процессе обмена  _ 1электронной
 _ 1цифровой подписи . 0.  При этом они могут в зависимости от взаимных до-
говорённостей подписывать послания,  содержащие либо открытые, либо
уже зашифрованные тексты;
   (4) шифровать саму (!) электронную подпись.

 ш1.2
   Для реализации этого  многообразия  возможных  вариантов  защиты
партнёрам  достаточно завести каждому по три пары открытых и закры-
тых ключей  (по одной паре для каждой из операций:   1аутентификации 0,
 1шифрования 0 и  1подписи 0) и обменяться открытыми ключами.
    2Пример 0 [Музыкантский,Фурин,2011,с.43].
 ш1.1
   Пусть два партнёра желают зашифровать свой компьютерный обмен.
   Тогда они могут действовать следующим образом:
   (а) A и B выбирают общий алгоритм шифрования E и соответствующий
ему алгоритм расшифрования D;
   (б) A выбирает пару ключей k 41 0 и k 42 0; при этом открытый ключ k 41 0 он
сообщает партнёру B, закрытый ключ k 42 0 остаётся известен только ему;
   (в) аналогично,  B выбирает пару ключей q 41 0 и q 42 0, а открытый ключ
q 41 0 сообщает своему партнёру A;
   (г) перед отправлением от A к B сообщение x шифруется отправите-
лем с использованием известного ему открытого ключа q 41 0 получателя B
и полученный зашифрованный текст E 4q1 0(x) пересылается получателю;
   (д) B  расшифровывает  полученный  текст E 4q1 0(x) с использованием
своего закрытого ключа q 42 0, известного только ему: D 4q2 0(E 4q1 0(x))=x;
   (е) аналогично сообщение от B к A сначала шифруется отправителем
B с использованием открытого ключа k 41 0 получателя A, и зашифрованный
текст E 4k1 0(x) пересылается A, который расшифровывает его с использо-
ванием своего закрытого ключа, т.е. D 4k2 0(E 4k1 0(x))=x.

 ш1.2
   Примерно по такой же схеме партнёры могут организовать процедуру
электронной цифровой подписи для своих сообщений. При этом отправи-
тель A должен организовать вычисление цифровой подписи своего сооб-
щения с использованием своего закрытого ключа, а получатель B орга-
низует проверку полученной подписи с использованием заранее ему из-
вестного открытого ключа отправителя A.
   Всё будет работать до тех пор, пока один из партнёров:
 ш1.1
   (1) не утратит свой закрытый ключ;
   (2) закрытый ключ не станет известен каким-либо третьим лицам.
 ш1.2

             2ПРИМЕРЫ РЕШЕНИЯ НЕКОТОРЫХ ТИПОВ УПРАЖНЕНИЙ

 ш1.0
                                           1Теории приходят и уходят,
                                           1а примеры остаются.
                                                        1И.М.Гельфанд
 ш1.2

    2Пример 1. 0 (По [Нечаев,1999,с.32-33])
   Приведите пример "ручной" реализации протокола  1электронной  под-
 1писи для двух абонентов 0.
    _ 1Решение . 0. Пусть банкир В выбирает простые числа 7 и 13,  вкладчик
W выбирает простые числа 11 и 23.
   Таким образом,
 ш1.0

   R= 7 77 013= 91, r= 11 77 023= 253.

 ш1.2
   Пусть S=5 -  1открытый ключ банкира 0, а s=31 -  1открытый ключ вклад-
 1чика 0.
   Далее, вычислим  1закрытый ключ банкира
 ш1.0

   5 77 0T 7= 0 1 ( 1mod 0 72) => T= 29,

и  1закрытый ключ вкладчика 0:

   31 77 0t 7= 0 1 ( 1mod 0 220) => t= 71.

 ш1.2
   Тогда  1открытая телефонная книга 0 имеет вид
 ш1.0

   ┌────────────────┐
   │В: R= 91,  S=  5│  Важно отметить, что R<r.
   │W: r= 253, s= 31│
   └────────────────┘

 ш1.2
   Вкладчик W  даёт  поручение m=41 банкиру В и, замечая, что  R<r,
шифрует его вначале открытым ключом банкира,  а затем своим секрет-
ным ключом:
 ш1.0

   m 41 7= 0 41 55 0 ( 1mod 0 91)= 6, m 42 7= 0 6 571 0 ( 1mod 0 253)= 94.

 ш1.2
   Банкир, получив шифрограмму m 42 0=94 и замечая,  что R<r, расшифро-
вывает её,  пользуясь сначала открытым ключом  вкладчика,  а  затем
своим закрытым ключом:
 ш1.0

   m 43 7= 0 94 531 0 ( 1mod 0 253)=6 1, 0 m 44 7= 0 6 529 0 ( 1mod 0 91)=41.

 ш1.2
   Так как 41<91, то банкир делает вывод, что 41  и есть распоряже-
ние этого вкладчика.
   Теперь предположим, что как вкладчик, так и банкир в своих дейс-
твиях  _ 1не обращают внимания . 0 (!) на значения r и R.
   Пусть, как и в примере, m=41.
   Рассмотрим (следуя [Нечаев,1999,с.33])  все возможные последова-
тельности применения ключей шифрования  (дешифрования)  банкиром  и
вкладчиком. Для этой цели будем символами O 4B 0 и O 4W 1  0обозначать откры-
тые ключи банкира и вкладчика соответственно и,  аналогично, симво-
лами C 4B 0 и C 4W 0 их закрытые ключи.
   Тогда представятся только четыре варианта:
 ш1.0

   (1) O 4B 0, C 4W 0, O 4W 0, C 4B 0;  (3) O 4B 0, C 4W 0, C 4B 0, O 4W 0;

   (2) C 4W 0, O 4B 0, C 4B 0, O 4W 0;  (4) C 4W 0, O 4B 0, O 4W 0, C 4B 0.

 ш1.2
   В самом деле 1, 0 отправляя сообщение, вкладчик пользуется или своим
закрытым ключом,  или открытым ключом банкира,  банкир же,  получая
сообщение, пользуется или своим закрытым ключом,  или открытым клю-
чом вкладчика.
    1Первая возможность 0 была рассмотрена в примере выше:
 ш1.0

   m 41 7= 041 55 7= 0 6 ( 1mod 0 91);   m 42 7= 0 6 571 7= 0 94 ( 1mod 0 253);

   m 43 7= 094 531 7= 0 6 ( 1mod 0 253); m 44 7= 0 6 529 7= 0 41 ( 1mod 0 91).

 ш1.2
    1Вторая возможность 0 такова:
 ш1.0

   m 41 7= 0 41 571 7= 0 115 ( 1mod 0 253); m 42 7= 0 115 55 7= 0 33 ( 1mod 0 91);

   m 43 7= 0 33 529 7= 0 24 ( 1mod 0 91);   m 44 7= 0 24 531 7= 0 24 ( 1mod 0 253).

 ш1.2
    1Третья возможность 0:
 ш1.0

   m 41 7= 0 41 55 7= 0 6 ( 1mod 0 91);   m 42 7= 0 6 571 7= 0 94 ( 1mod 0 253);

   m 43 7= 0 94 529 7= 0 61 ( 1mod 0 91); m 44 7= 0 61 531 7= 0 83 ( 1mod 0 253).

 ш1.2
    1Четвёртая возможность 0:
 ш1.0

   m 41 7= 0 41 571 7= 0 115 ( 1mod 0 253); m 42 7= 0 115 55 7= 0 33 ( 1mod 0 91);

   m 43 7= 0 33 531 7= 0 66 ( 1mod 0 253);  m 44 7= 0 66 529 7= 0 53 ( 1mod 0 91).

 ш1.2
   Итак, при r<R к правильному результату  приводит   _ 1только . 0  первый
вариант применения открытых и закрытых ключей,  а в случае R<r пос-
ледовательность процедур должна быть изменена.
                     3Использование пакета Maple
    2Пример 2. 0 Демонстрация реализации  1протокола электронной цифровой
 1подписи 0  1для двух абонентов 0 с помощью пакета Maple  для  "маленьких"
натуральных чисел.
 ш1.0

   > with(numtheory);
   > # Банкир выбирает два случайных простых числа p1 и p2 и
   > # случайное целое число 0<S<phi(p1*p2), (S,phi(p1*p2))=1.
   > # Ключи R и S являются открытыми ключами
   > # --------------------------------------
   > p1:=nextprime(234232341231121);
   > p2:=nextprime(21233333);
   > R:=p1*p2; phBank:=phi(R);
   > S:=29; igcd(S,phBank);
                        p1:=234232341231283
                           p2:=21233339
                     R:=4973534706127509343937
                  phBank:=4973534471895146879316
                               S:=29
                                 1

   > # Вкладчик B1 выбирает два случайных простых числа p1 и q1 и
   > # случайное целое число 0<s1<phi(q1*q2), (s1,phi(q1*q2))=1.
   > # Ключи r1 и s1 являются открытыми ключами
   > # ----------------------------------------
   > q1:=nextprime(131111231121);
   > q2:=nextprime(12171212311231);
   > r1:=q1*q2; ph1:=phi(r1);
   > s1:=37; igcd(s1,ph1);
                         q1:=131111231129
                        q2:=12171212311261
                   r1:=1595782630461871260443669
                  ph1:=1595782630449568936901280
                              s1:=37
                                 1

   > # Банкир вычисляет секретный ключ T
   > T:=S&^(phi(phBank)-1) mod phBank;

                     T:=1372009509488316380501

   > # Вкладчик B1 вычисляет секретный ключ t1
   > t1:=s1&^(phi(ph1)-1) mod ph1;

                    t1:=43129260282420782078413

   > # Вкладчик даёт банкиру распоряжение m (важно, чтобы m<r1)
   > m:=123456789101112131415;

                     m:=123456789101112131415

   > # Распоряжение шифруется и дешифруется в зависимости от
   > # выполнения условия r1<R
   > if r1<R
   >   then m1:=m  &^t1 mod r1;  m2:=m1 &^ S  mod R;
   >        m3:=m2 &^T  mod R;   m4:=m3 &^ s1 mod r1
   >   else m1:=m  &^S  mod R;   m2:=m1 &^ t1 mod r1;
   >        m3:=m2 &^s1 mod r1;  m4:=m3 &^ T  mod R
   > fi;
                     m1:=747257612868964144333
                   m2:=1016150129732267112894065
                     m3:=747257612868964144333
                     m4:=123456789101112131415
 ш1.2

    2Пример 3. 0 Демонстрация реализации  1протокола электронной цифровой
 1подписи для двух абонентов 0 с помощью пакета Maple для "больших" на-
туральных чисел.
 ш1.0

   > with(numtheory):
   > # -----------------------------------------------------
   > # Банкир выбирает два случайных простых числа p1 и p2 и
   > # случайное целое число 0<S<phi(p1*p2), (S,phi(p1*p2))=1.
   > # Ключи R и S являются открытыми ключами
   > # ------------------------------------------------------------
   > p1:=1942668892225729070919461906823518906642406839052139521251
         812409738904285205208498221;
   > p2:=1989292945639146568621528992587283360401824603189390869761
         855907572637988050133502132777;
   > R:=p1*p2; phBank:=(p1-1)*(p2-1);
   > S:=123876132205208335762278423601; # igcd(S,phBank);
   > # ----------------------------------------------------------
   > # Вкладчик B1 выбирает два случайных простых числа p1 и q1 и
   > # случайное целое число 0<s1<phi(q1*q2), (s1,phi(q1*q2))=1.
   > # Ключи r1 и s1 являются открытыми ключами
   > # ------------------------------------------------------------
   > q1:=4171849679533027504677776769862406473833407270227837441302
         815640277772901915313574263597826351;
   > q2:=2669983794901137602993777132711940143253380652945815962433
         80200977777465722580068752870260867081;
   > r1:=q1*q2; ph1:=(q1-1)*(q2-1);
   > s1:=1786393878363164227858270210279; # igcd(s1,ph1);
   > # --------------------------------------------------
   > # Банкир вычисляет секретный ключ T
   > # -----------------------------------------------------
   > T:='T'; sols:=msolve(S*T=1,phBank); assign(sols); T:=T; 
   > # -----------------------------------------------------
   > # Вкладчик B1 вычисляет секретный ключ t1
   > # ----------------------------------------------------------
   > t1:='t1'; sols1:=msolve(s1*t1=1,ph1); assign(sols1); t1:=t1; 
   > # ----------------------------------------------------------
   > # Вкладчик даёт банкиру распоряжение m (важно, чтобы m<r1)
   > # --------------------------------------------------------
   > m:=812341242521515435903200431245123343674951737516;
   > Log:=r1-R;  # Проверка знака разности
   > # -----------------------------------------------------
   > # Распоряжение шифруется и дешифруется в зависимости от
   > # выполнения условия r1<R
   > # -----------------------
   > if r1<R 
   >    then m1:=m  &^ t1 mod r1;  m2:=m1 &^ S  mod R;
   >         m3:=m2 &^ T  mod R;   m4:=m3 &^ s1 mod r1
   >    else m1:=m  &^ S  mod R;   m2:=m1 &^ t1 mod r1;
   >         m3:=m2 &^ s1 mod r1;  m4:=m3 &^ T  mod R
   > fi;

   p1:=19426688922257290709194619068235189066424068390521395212518\
       12409738904285205208498221
   p2:=19892929456391465686215289925872833604018246031893908697618\
       55907572637988050133502132777
   R:=386453752301725834469535189093198734429892732970643499865723\
      525145151914228956042462678624503308500172665088313240333435\
      0820436786561409950278676776821404280671468710289717
   phBank:=3864537523017258344695351890931987344298927329706434998\
           6572352514515191422895604246247950094185536294289584346\
           7790922747151196977653296694099556905683902738833612999\
           9658720
                 S:=123876132205208335762278423601

   q1:=41718496795330275046777767698624064738334072702278374413028\
       15640277772901915313574263597826351
   q2:=26699837949011376029937771327119401432533806529458159624338\
       0200977777465722580068752870260867081
   r1:=11138771039116687545510672865479226867415108660274804518015\
       60673315252726369306002564920120031468182531702861728994369\
       20943665754995898474223242784122623243533278170735398521436\
       6888130251431
   ph1:=1113877103911668754551067286547922686741510866027480451801\
        5606733152527263693060025649201200311970123025332149411903\
        1371939560112915981326966761840754154941871472646872948983\
        2039754271558000
                s1:=1786393878363164227858270210279

                               T:=T
   sols:={T = 2307265950424115339804600398128368899935333772682076\
              0916802010085262936712428484808789799178238686839154\
              6511979031816145699166271734056411976690385722713794\
              0434810257460401}
   T:=230726595042411533980460039812836889993533377268207609168020\
      100852629367124284848087897991782386868391546511979031816145\
      6991662717340564119766903857227137940434810257460401

                              t1:=t1
   sols1:={t1 = 10905655025228916182926990204175343222472034155664\
                37878802477735053283172357254489347820225363132143\
                00223668805791968234988454323890072579294198446361\
                6233718226914091858983777397034416153319}
   t1:=10905655025228916182926990204175343222472034155664378788024\
       77735053283172357254489347820225363132143002236688057919682\
       34988454323890072579294198446361623371822691409185898377739\
       7034416153319

        m:=812341242521515435903200431245123343674951737516

   Log:=1113877103911668750686529763530664342046158975095493107502\
        6333436088177277120707511134009777419077579049166166959093\
        6748278577441755565039141199105466482248505410493053258093\
        3695419419961714
   m1:=24851182277793781155165412752146432743771781289956323306606\
       37496138268551978832175234052223930872088054190338920418878\
       926479375920337706284851138975131623170385268669095130
   m2:=73489742554402060454691702809631186932817767813057502440882\
       01689811543729592373210225923005200398839487519368071635351\
       66855427900196918680433211395236453568380666048559059355500\
       695895883062
   m3:=24851182277793781155165412752146432743771781289956323306606\
       37496138268551978832175234052223930872088054190338920418878\
       926479375920337706284851138975131623170385268669095130
       m4:=812341242521515435903200431245123343674951737516

   > test:=m-m4;  # Проверка правильности пересылки текста m...
                              test:=0
 ш1.2
   Итак, банкир делает вывод, что m4 и есть распоряжение вкладчика.

                 2ЗАДАЧИ ДЛЯ САМОСТОЯТЕЛЬНОГО РЕШЕНИЯ

 ш1.0
                        1Они вчетвером держали изящную машину, покуда
                        1я взбирался на седло, потом строились колон-
                        1ной и маршировали по обеим сторонам, а  инс-
                        1труктор подталкивал меня сзади. 0
                                        1М.Твен. Укрощение велосипеда
 ш1.2

                   21. 3 Криптографические протоколы
    _ 1Указание . 0 ( 1важное 0).
 ш1.1
   В задачах №№ 1-2 будем предполагать, что 1  0  1h 0(m)  ═+ 0 m для всех зна-
чений m.

 ш1.2
    21. 0 [Рябко,Фионов,2018,с.62,№4.1]
   Постройте подпись  RSA  для сообщения m при следующих параметрах
пользователя:
 ш1.0

   (а) P=5, Q=11, 3 e 0=27, m= 7;  (г) P=7, Q=13, 3 e 0=29, m=15;
   (б) P=5, Q=13, 3 e 0=29, m=10;  (д) P=3, Q=11, 3 e 0= 7, m=24.
   (в) P=7, Q=11, 3 e 0=43, m= 5;

 ш1.2
    22. 0 [Рябко,Фионов,2018,с.62,№4.2]
   Для указанных открытых ключей пользователя RSA проверьте подлин-
ность подписанных сообщений:
 ш1.0

   (а) N=55,  3d 0=3: ( 7,28), (22,15), (16,36);
   (б) N=65,  3d 0=5: 3  0( 6,42), (10,30), ( 6,41);
   (в) N=77,  3d 0=7: (13,31), (11,28), ( 5,26);
   (г) N=91,  3d 0=5: (15,71), (11,46), (16,74);
   (д) N=33,  3d 0=3: 3  0(10,14), (24,18), (17, 8).

 ш1.2
                    22. 0  3Задачи на программирование
    21 4* 2. 0 Реализуйте с помощью  системы  символьных  вычислений  Maple
протоколы:
 ш1.1
   (1) электронной подписи RSA без секретной передачи сообщения;
   (2) электронной подписи RSA без секретной передачи сообщения  (с
хэшированием);
   (3) электронной подписи RSA совместно с секретной передачей  со-
общения;
   (4) аутентификации;
   (5) подписи "вслепую" (по [Ростовцев,Маховенко,2001,с.192-193]).

 ш1.2
    22. 0 [Рябко,Фионов,2018,с.63,№4.7]
   Разработайте программы для генерации и проверки подписей RSA.
   Параметры пользователей выберите  1самостоятельно 0.
   Для тестирования  программы  проверки  подписи рекомендуется ис-
пользовать подписанное сообщение  ═< 0500,46514 ═> 0  для  открытых  ключей
пользователя N=52891, 3 d 0=3.
   Предполагаем, что  1h 0(m)  ═+ 0 m для всех значений m.
   Данное сообщение должно признаваться истинным.
   Любое изменение  подписанного  сообщения   _ 1с большой вероятностью
будет делать подпись недействительной.
    23 5* 2. 0 [Рябко,Фионов,2018,с.96,№5.4]
   Выполните компьютерную реализацию протокола доказательства с ну-
левым знанием на основе задачи о  раскраске  графа,   1самостоятельно
выбрав все необходимые параметры.

    _ 1Домашнее задание . 0:
 ш1.0

   №№  22 41(1,2,3,4,5) 0  ( 15 задач 0).

 ш1.2
.
                23 41 2. 0  3Электронная 0  3подпись RSA совместно
                   3с секретной передачей сообщения
   Вспомним, что используя криптосистему с открытым ключом, получа-
тель сообщения не знает, кто является отправителем, но криптосисте-
ма " 1электронная цифровая подпись 0" лишена этого недостатка.
   Предположим (по [Нечаев,1999,с.31-32]), что  имеется  банкир В и
несколько вкладчиков W 41 0, W 42 0,...
   Банкир и  каждый из вкладчиков независимо друг от друга выбирают
по два больших простых числа и держат их в секрете.
   Пусть Р и Q - закрытые простые числа банкира, p 4n 0 и q 4n 1  0- закрытые
простые числа вкладчика W 4n 1,  0n=1,2,....
   Далее вычисляются
 ш1.0

   R  ═+ 0 Р 77 0Q, r 4n 0  ═+ 0 p 4n 77 0q 4n 1,  0n=1,2 1, 03,....

 ш1.2
   Пусть банкир В выбирает случайное целое число S, удовлетворяющее
следующим условиям:
 ш1.0

   0<S< 7f 0(R), (S, 7f 0(R))= 1,

 ш1.2
а каждый из вкладчиков также случайно и независимо  друг  от  друга
выбирает число s 4n 0, удовлетворяющее условиям
 ш1.0

   0<s 4n 0< 7f 0(r 4n 0) 1, 0 (s 4n 1, 7f 0(r 4n 0))= 1, n=1,2,3,....

 ш1.2
   После этого публикуется  _ 1доступная всем . 0 телефонная книга:
 ш1.0

   ┌─────────────────╥─────┬───────┬───────┬───┬───────┐
   │ 3Банкир, вкладчики 0║  B  │   W 41 0  │   W 42 0  │...│   W 4n 0  │
   ├─────────────────╫─────┼───────┼───────┼───┼───────┤
   │  3Открытые ключи 0  ║(R 1, 0S)│(r 41 1, 0s 41 0)│(r 42 0,s 42 0)│...│(r 4n 0,s 4n 0)│
   └─────────────────╨─────┴───────┴───────┴───┴───────┘

 ш1.2
   Далее, банкир находит  _ 1закрытый ключ . 0  1Т 0 из уравнения:
 ш1.0

   S 77 0T 7= 0 1 ( 1mod 0  7f 0(R)) 1, 0 0<T< 7f 0(R) 1,

 ш1.2
   Вкладчики находят свои  _ 1закрытые ключи . 0  1t 4n 0 из уравнений:
 ш1.0

   s 4n 77 0t 4n 7= 01 ( 1mod 0  7f 0(r 4n 0)) 1, 0 0<t 4n 0< 7f 0(r 4n 0), 1  0n=1,2,....

 ш1.2
   Пусть вкладчик W 4k 0 собирается дать банкиру распоряжение
 ш1.0

   m, m<r 4k 0, (m,r 4k 0)=1.

 ш1.2
   Рассмотрим два случая.
 ш1.0

  ┌──┐
  │ 21. 0│ 0<r 4k 0<R 1.
  └──┘

 ш1.2
   Вкладчик шифрует распоряжение m  1своим закрытым ключом 0:
 ш1.0
         4t
   m 41 7= 0 m 4  5k 0 ( 1mod 0 r 4k 0) 1,  00<m 41 0<r 4k 0,

а затем -  1открытым ключом банкира 0:

   m 42 7= 0 m 41 5S 0 ( 1mod 0 R) 1,  00<m 42 0< 1R.

 ш1.2
   Банкир В, получив шифрованную телеграмму m 42 0, расшифровывает  её,
пользуясь  1своим закрытым ключом 0  1T 0:
 ш1.0

   m 43 7= 0 m 42 5T 0 ( 1mod 0 R) 1,  00<m 43 0<R,

а затем -  1открытым ключом вкладчика 0 s 4k 0:
          4s
   m 44 7= 0 m 43  5k 0 ( 1mod 0 r 4k 0) 1,  00<m 44 0<r 4k 0.

 ш1.2
   В результате банкир В получит распоряжение m 44 0 от вкладчика W 4k 0.
 ш1.0

  ┌──┐
  │ 22. 0│ 0<R<r 4k 1.
  └──┘

 ш1.2
   Вкладчик шифрует распоряжение m  1открытым ключом банкира 0:
 ш1.0

   m 41 7= 0 m 5S 0 ( 1mod 0 R) 1,  00<m 41 0<R,

а затем - своим  1закрытым ключом 0:
          4t
   m 42 7= 0 m 41  5k 0 ( 1mod 0 r 4k 0) 1,  00<m 42 0<r 4k 0.

 ш1.2
   Банкир В, получив шифрованную телеграмму m 42 0, расшифровывает  её,
пользуясь  1открытым ключом вкладчика 0 s 4k 0:
 ш1.0
          4s
   m 43 7= 0 m 42  5k 0 ( 1mod 0 r 4k 0) 1,  00<m 43 0<r 4k 0.

а затем -  1своим закрытым ключом 0  1T 0:

   m 44 7= 0 m 43 5T 0 ( 1mod 0 R) 1,  00<m 44 0<R.

 ш1.2
   В результате банкир В получит распоряжение m 44 0 от вкладчика W 4k 0.
    2Теорема 0.
 ш1.1
    2(1) 0 Если 0<r 4k 0<R, то m 44 0=m.
    2(2) 0 Если 0<R<r 4k 0, то m 44 0=m.

 ш1.2
    2Доказательство 0.
    2(1) 0 Воспользуемся транзитивностью сравнений:
 ш1.0

   m 43 7= 0 m 42 5T 0 ( 1mod 0 R) 1, 0 m 42 7= 0m 41 5S 0 ( 1mod 0 R) => m 43 7= 0m 41 5ST 0 ( 1mod 0 R) =>

     => 1 ind 4g 0m 43 7= 0 ST 77 1ind 4g 0m 41 0 ( 1mod 0  7f 0(R)) =>  1ind 4g 0m 43 7= 0  1ind 4g 0m 41 0 ( 1mod 0  7f 0(R)) =>

     => m 43 7= 0 m 41 0 ( 1mod 0 R), 0<m 43 0<R, 0<m 41 0<r 4k 0<R => m 43 0=m 41 0.

 ш1.2
   Дальнейшее очевидно, в силу того, что s 4k 0t 4k 7= 01 (mod  7f 0(r 4k 0)):
 ш1.0
          4s 0  2  0    4s  2  4  0  4 s t
   m 44 7= 0 m 43  5k 7= 2  0m 41 0  5k 2  7= 0 m 4  5k 0  5k 0 ( 1mod 0 r 4k 0) =>

           => m 44 7= 2  0m ( 1mod 0 r 4k 0), 0<m<r 4k 0, 0<m 44 0<r 4k 0 => m 44 1= 0 m.

 ш1.2
    2(2) 0  1Упражняйтесь 0.
    1Теорема доказана 0.
   Итак, мы рассмотрели передачу аутентифицированного сообщения  от
A к  B способом,  который называется  _ 1зашифровать и подписать . 0,  т.е.
абонент A вначале шифрует данные с помощью открытого ключа B, а за-
тем  ставит  на  зашифрованные данные свою цифровую подпись (либо с
использованием, либо без использования хэширования).
                  3Работа с примерами решённых задач
 ш1.1
   См. Пример 1, Пример 2, Пример 3.
 ш1.2
.
