    2УПРАЖНЕНИЕ 8.
    2КРИПТОАНАЛИЗ СИСТЕМЫ RSA

 ш1.0
         1- Ну-с,  когда вы входите в дом,  то стол уже  должен  быть
         1накрыт,  а  когда  сядете,  сейчас салфетку за галстук и не
         1спеша тянетесь к графинчику с водочкой. Да её, мамочку, на-
         1ливаете  не в рюмку,  а в какой-нибудь допотопный дедовский
         1стаканчик из серебра или в этакий  пузатенький  с  надписью
         1"его же и монаси приемлют", и выпиваете не сразу, а сначала
         1вздохнете,  руки потрете,  равнодушно на потолок поглядите,
         1потом этак не спеша,  поднесете её, водочку-то, к губам и -
         1тотчас же у вас из желудка по всему телу искры... 0
                                                   1А.П.Чехов. Сирена
 ш1.2

                  2ОБЯЗАТЕЛЬНЫЕ РЕЗУЛЬТАТЫ ОБУЧЕНИЯ
    _ 1Предварительные понятия . 0:
 ш1.0
    1- криптографическая система с открытым ключом 0;
   -  1криптоанализ 0.

 ш1.2
    _ 1Основные понятия . 0:
 ш1.0
    1- пассивная атака, активная атака 0;

    1- 0  _ 1классификация криптоаналитических атак . 0;
      1- только по зашифрованному тексту 0;
      1- по известному открытому тексту 0;
      1- по выбранному открытому тексту 0;
      1- по динамически выбираемому открытому тексту 0;
      1- по выбранному зашифрованному тексту 0;
      1- по динамически выбираемому зашифрованному тексту 0;

    1- 0  _ 1атаки на алгоритм 0  1и протокол RSA . 0:
      1- вычислением закрытого 0  1ключа по открытому ключу 0;
      1- угадыванием значения 0  1функции Эйлера 0;
     -  1атака с помощью разложения на множители методом Ферма 0;

      1- 0  1с использованием общего модуля 0;
      1- 0  1с малой экспонентой 0;
     -  1атака методом неподвижной точки 0;
      1- атака на короткий открытый текст 0;
      1- атака Винера 0;
      1- атаки, основанные на анализе времени выполнения операций 0;

      1- 0  1с помощью выбранного 0  1шифртекста-1 0;
      1- 0  1с помощью выбранного шифртекста-2 0;
      1- 0  1с помощью выбранного шифртекста-3 0;

    1- атака 0  1на зашифрование и цифровую подпись 0;
    1- 0  1метод защиты от активной атаки с помощью хэширования 0.

    _ 1Уметь . 0:
    1- 0  1реализовать атаки на алгоритм и протокол RSA 0.
 ш1.2

                       2ТЕОРЕТИЧЕСКИЕ СВЕДЕНИЯ
   Со временем стало очевидным,  что некоторые хорошо известные ал-
горитмы шифрования с открытым ключом (мы  называем  их  "учебными")
имеют слабые места:
 ш1.1
   (а) в них существует утечка частичной информации о зашифрованном
сообщении;
   (б) они чрезвычайно уязвимы для активных атак.

 ш1.2
   Это значит, что "учебная" криптография  _ 1непригодна для практичес-
 _ 1ких целей . 0.
   Первые попытки полностью устранить эти недостатки  и  предотвра-
тить активные  атаки неизменно содились к средствам аутентификации.
Эти результаты были весьма ценными для дальнейшего развития  гаран-
тированно стойких  алгоритмов  шифрования с открытым ключом, однако
оставались непригодными для практического применения.

   Для построения надёжной криптосистемы  необходимо  принимать  во
внимание  методы взлома,  которые может применить злоумышленник,  и
выбирать параметры криптосистемы (в частности,  длины  чисел)  так,
чтобы сделать эти методы практичеки нереализуемыми.
   Рассмотрим ниже несколько методов,  для того,  чтобы дать предс-
тавление об этой "таинственной" области.

                       3Математические сведения

 ш1.0
               1Звучала молитва так,
               1"Господи, дай мне душевный покой, чтобы принимать то,
               1чего я не могу изменить,  мужество - изменять то, что
               1могу, и мудрость - всегда отличать одно от другого". 0
               1К тому, чего Билли изменить не мог, относилось  0  1прош-
               1лое, настоящее и будущее.
                                   1К.Воннегут. Бойня номер пять, или
                                               1Крестовый поход детей
 ш1.2

    2Теорема 1 0.
 ш1.1
   Задача разложения числа n=p 77 0q и задача вычисления функции Эйлера
полиномиально эквивалентны.

 ш1.2
    2Доказательство 0. Если известно разложение числа n=p 77 0q,  то значе-
ние  7f 0(n)=(p-1) 77 0(q-1) вычислимо с не более  чем  квадратичной  слож-
ностью относительно количества битов в числах p и q.
   Если же известно значение  7f 0(n), то делители являются целочислен-
ными корнями  1квадратного уравнения
 ш1.0

        4┌ 0         4┐
   x 52 0- │n- 7f 0(n)+1│ 77 0x + n= 0.
        4└ 0         4┘

 ш1.2
   Сложность решения этого уравнения оценивается кубическим многоч-
леном от 1 log 42 0n ( 1почему 0?).
    1Лемма доказана 0.
    2Теорема 2 0.
 ш1.1
   Задача вычисления закрытого ключа 3 d 0 системы RSA сводится с поли-
номиальной сложностью к задаче вычисления функции 7  0Эйлера  7f 0(n).

 ш1.2
    2Доказательство 0. Пусть мы умеем вычислять   7f 0(n), а  3e 0  -  открытый
ключ системы RSA.
   Тогда, применяя  1обобщённый алгоритм Евклида 0 к паре ( 3e 0, 7f 0(n)), по-
лучим два целых числа a, b, удовлетворяющих равенству
 ш1.0

   a 77 3e 0 + b 77f 0(n)= 1, 0<a< 7f 0(n), 0<b< 3e 0.

 ш1.2
   Далее, с помощью сравнения 3 e 77 3d 7= 01 1 mod 0  7f 0(n) получим:
 ш1.0

   (a 77 3e 0 + b 77f 0(n))  1mod 0  7f 0(n)= a 77 3e 0  1mod 0  7f 0(n) + b 77f 0(n)  1mod 0  7f 0(n)=

                          = a 77 3e 0  1mod 0  7f 0(n)=1 => a= 3d 0.

 ш1.2
   Сложность нахождения числа 3 d 0 является квадратичной от 1 log 42 0n.
    1Теорема доказана 0.

                          3Основные понятия

 ш1.0
                    1Нет ничего тайного, что не сделалось бы явным...
                                               1Мрк, 4, 22 0; 1 Лк, 8, 17
                    1... ибо нет ничего  сокровенного, что  не откры-
                    1лось бы, и тайного, что не было бы узнано. 0
                                                         1Мтф, 10, 26
 ш1.2

    2Определение 0 [Утешев,Черкасов,Шапошников,2001,с.99].
 ш1.1
    _ 1Криптоанализом . 0 будем  называть совокупность действий потенциаль-
ного противника, направленных на достижение какой-либо из следующих
целей:
   (1) установления ключа дешифрования;
   (2) дешифрования конкретного пересылаемого сообщения;
   (3) искажения содержания конкретного пересылаемого сообщения.

 ш1.2
   Мы будем также считать,  что противник (криптоаналитик) не имеет
непосредственного доступа к генератору шифра, но в то же время:
 ш1.1
   (1) имеет неограниченный доступ к коммуникациям, т.е. перехваты-
вает любое шифрованное сообщение;
   (2) знает  все  алгоритмы кодирования,  шифрования и контроля за
целостностью содержания пересылаемых сообщений;
   (3) может  иметь  частичную  информацию  о  содержании открытого
текста пересылаемой шифровки.

 ш1.2
    2Определение 0.
 ш1.1
    2(1) 0  _ 1Атакой . 0 называется метод криптоанализа, нацеленный на раскры-
тие засекреченной информации.
    2(2) 0  _ 1Пассивной атакой на шифровку . 0 называется атака, которая имеет
целью только ознакомление с содержанием, т.е. целью атаки  является
нарушение конфиденциальности.
    2(3) 0  _ 1Активной атакой на шифровку . 0 называется  атака, которая  нап-
равлена на изменение содержания шифровки.
 ш1.2

                        3Классификация крипто-
                         3аналитических атак 0

 ш1.0
                     1По-настоящему безопасной  можно  считать   лишь
                     1систему, которая выключена, замурована в бетон-
                     1ный корпус, заперта  в помещении со  свинцовыми
                     1стенами и охраняется вооруженным караулом, - но
                     1и в этом случае сомнения не оставляют меня. 0
                                                    1Юджин Х. Спаффоpд
 ш1.2

   Криптоаналитические атаки  делятся   _ 1на шесть категорий . 0,  которые
различаются информацией,  доступной криптоаналитику. Типу атак при-
ведены в порядке усложнения качества информации, доступной криптоа-
налитику, или (что та же  самое)  в  порядке  уменьшения  сложности
криптоанализа [Исагулиев,2004,с.85-86].
   Цель криптоаналитика во всех случаях состоит в следующем:
 ш1.1
   (1) расшифровать часть зашифрованного текста,  не имея  дополни-
тельной информации;
   (2) ( 1идеальный случай 0) извлечь и закрытый ключ шифрования.

 ш1.2
    21 0.  _ 1Атака только по зашифрованному тексту
      (англ.  1ciphertext only 0).
 ш1.1
   Случай, когда криптоаналитик имеет образец зашифрованного  текс-
та, однако не имеет связанного с ним открытого текста.
   Эти данные  относительно легко получить во многих сценариях,  но
атака только по зашифрованному тексту трудна,  и для неё  необходим
очень большой образец зашифрованного текста.

 ш1.2
    22 0.  _ 1Атака по известному открытому тексту
      (англ.  1known plaintext 0).
 ш1.1
   Криптоаналитик получает  образец зашифрованного текста,  а также
соответствующего ему открытого текста.

 ш1.2
    23 0.  _ 1Атака по выбранному открытому тексту . 0.
      (англ.  1chosen plaintext 0).
 ш1.1
   Криптоаналитик может   выбрать  некоторое  количество  открытого
текста, а затем получить соответствующий зашифрованный текст.

 ш1.2
    24 0.  _ 1Атака по динамически выбираемому открытому тексту . 0.
      (англ.  1adaptive chosen plaintext 0).
 ш1.1
   Специальный случай  атаки по выбранному открытому тексту,  когда
криптоаналитик может динамически выбирать образцы открытого  текста
и изменять свой выбор по своим предыдущим результатам.

 ш1.2
    25 0.  _ 1Атака по выбранному зашифрованному тексту . 0.
      (англ.  1chosen ciphertext 0).
 ш1.1
   Криптоаналитик может выбрать часть зашифрованного текста и пыта-
ется получить соответствующий расшифрованный открытый текст.
   Этот тип  атаки чаще всего применяется к криптосистемам с откры-
тым ключом.

 ш1.2
    26 0.  _ 1Атака по динамически выбираемому 0  1зашифрованному тексту
      (англ.  1adaptive chosen ciphertext 0).
 ш1.1
   Отдельная версия атаки по зашифрованному тексту.
   Криптоаналитики используют  эту  атаку,  когда в их распоряжении
имеется часть шифровального аппарата,  из которого,  однако, нельзя
извлечь ключ шифрования/расшифровывания.

 ш1.2
   Выделяют несколько  _ 1видов атак на криптосистемы . 0 в зависимости  от
того, какой информацией обладает криптоаналитик [Ян,2011,с.66]:
 ш1.1
   (1)  1атака, основанная только на знании шифртекста 0.
   Криптоаналитику известен только шифртекст, а его задачей являет-
ся получение  соответствующего открытого текста и,  возможно,  ключ
шифрования. Это наиболее сложный вид атаки,  поэтому криптосистема,
для которой существует атака этого типа, считается совершенно неза-
щищённой;
   (2)  1атака, основанная на знании открытого текста и соответствую-
 1щего шифротекста 0.
   Криптоаналитик знает открытый текст и соответствующий шифртекст.
Целью атаки является определение ключа для того, чтобы расшифровать
сообщения, зашифрованные с помощью ключа;
   (3)  1атака, основанная на основе подобранного открытого текста 0.
   Криптоаналитик имеет  временный  доступ к средствам криптографи-
ческой защиты информации и может подавать на вход произвольный отк-
рытый текст и получить соответствующий шифртекст.
   В данном случае целью криптоаналитика является определение ключа
шифрования;
   (4)  1атака, основанная на основе подобранного шифротекста 0.
   Криптоаналитик имеет  временный  доступ к средствам криптографи-
ческой защиты информации и  может  подавать  на  вход  произвольный
шифртекст и получать соответствующий открытый текст.
   Аналогично предыдущим типам атак целью является получение  ключа
шифрования.

 ш1.2
    3Замечания 0 ( 1важные 0).
 ш1.1
    21. 0 [Ян,2011,с.67] Криптосистема RSA подвержена атакам на  основе
 _ 1подобранного  шифротекста . 0,  поскольку криптоаналитик имеет доступ к
средствам криптографической защиты информации и может  подавать  на
вход  произвольный  шифротекст  и получать соответствующий открытый
текст.
   Фактически криптосистемы  с  открытым ключом уязвимы к атакам на
основе подобранного  шифртекста,  правда,  в  качестве  эффективной
контрмеры к открытому тексту можно добавлять некоторую избыточность
или  _ 1последовательность случайных битов . 0 (дополнение случайными бита-
ми) перед тем, как выполнять шифрование.
    22. 0 Более того, для уменьшения эффективности атак каждый ключ мо-
жет быть дополнен n-битовой случайной последовательностью, называе-
мой  " _ 1солью . 0" (англ.  1salt 0), которая изменяет "вкус" ключа перед при-
менением однонаправленной функции.
   Как хэшированный ключ,  дополненный "солью",  так и "соль" могут
записываться в некоторый  файл,  а  когда  в  будущем  пользователь
предъявляет ключ, то система находит "соль" и применяет однонаправ-
ленную функцию к ключу, дополненному "солью".
    23. 0 Чтобы спроектировать надёжный алгоритм шифрования  или  крип-
тографический протокол,  необходимо с помощью криптоанализа найти и
устранить любые слабости.
 ш1.0

    4┌ 0───────────────────────────────────────────────────────── 4┐
   │По этой причине наиболее надёжными алгоритмами шифрования│
   │являются те, которые были  _ 1доступны . 0 для публичного  изуче-│
   │ния и тестирования.                                      │
    4└ 0───────────────────────────────────────────────────────── 4┘

 ш1.1
    24. 0 Известно  7~ 0 30 атак на алгоритм RSA.
 ш1.2

                   2Криптоанализ RSA для квантовых
                            2вычислителей

 ш1.0
                     1Математика требует  всё большего и большего му-
                     1жества, чтобы принять результаты её применения.
                                     1М.Крайтон. Парк юрского периода
 ш1.2

   Напомним, что N  ═+ 0 p 77 0q.
   В криптосистеме RSA предполагается, что криптоаналитик Ева:
 ш1.1
   (а) знает открытый ключ { 3e 0,N}, а также шифротекст C;
   (б) не знает ни один из элементов множества {p,q, 7f 0(N), 3d 0},  кото-
рые составляют закрытый ключ;
   (в) желает узнать открытый текст M.

 ш1.2
   Отсюда получаем  _ 1основную задачу 0  1криптоаналитика 0  1RSA . 0:
 ш1.0

    7( 0                  7) 0 ?
    7* 3e 0,N,C 7= 0 M 5e 0 (mod N) 78 0 => M.
    79 0                  70

 ш1.2
   Существует несколько  способов получить M из шифрованного текста
C, т.е.  реализовать успешную атаку на систему RSA с использованием
квантового компьютера:
 ш1.1
   (1) выполнить  _ 1факторизацию . 0 N, получив {p,q}, а затем вычислить
 ш1.0

        51/e 0 mod (p-1) 77 0(q-1)
   M 7= 0 C 5         0           (mod N);

 ш1.1
   (2) найти 7  0значение  _ 1функции Эйлера . 0  7f 0(N), чтобы вычислить
 ш1.0

        51/e 0 mod  7f 0(N)
   M 7= 0 C 5         0    (mod N);

 ш1.1
   (3) найти  _ 1порядок . 0 C  _ 1по модулю . 0 N (обозначается  1order 0(C,N)), а за-
тем вычислить
 ш1.0

        51/e 0 mod  1order 0(C,N)
   M 7= 0 C 5         0          (mod N);

 ш1.1
   (4) найти  порядок случайного целого числа  1a 7е 0[2,N-2] по модулю N,
который обозначим r  ═+ 0  1order 0( 1a 0,N), затем вычислить
 ш1.0

   {p,q}=  1gcd 0( 1a 5r/2 7+ 01, N),

выполнение N=p 77 0q, и наконец,

        51/e 0 mod (p-1) 77 0(q-1)
   M 7= 0 C 5         0           (mod N);

 ш1.1
   (5) вычислить log 4C 0M mod N (это дискретный логарифм M по  основа-
нию C по модулю N), чтобы затем найти
 ш1.0

       log 4C 0M mod N
   M 7= 0 C 5         0   (mod N).

 ш1.2
    3Замечания 0 ( 1важные 0).
 ш1.1
    21. 0 Алгоритм RSA беззащитен перед  _ 1квантовыми вычислениями . 0, т.к. в
этом  случае  возможно совершить разложение на простые множители за
полиномиальное время (см.  _ 1алгоритм Шора . 0).
    22. 0 Если  появится  возможность  создать квантовый компьютер,  то
можно сразу же применять квантовый алгоритм факторизации Шора, про-
пуская все классические алгоритмы факторизации.
 ш1.2

                  2Простейшие атаки на протокол RSA

 ш1.0
                  1Милый мальчик, ты так весел, так
                                               1светла твоя улыбка,
                  1Не проси об этом счастье, отравляющем миры,
                  1Ты не знаешь, ты не знаешь, что такое эта скрипка,
                  1Что такое тёмный ужас начинателя игры.
                                 1Н.Гумилёв. Волшебная скрипка 0 ( 11908 0)
 ш1.2

                   21. 0  3Атака 0  3вычислением закрытого
                      3ключа по открытому ключу
   В криптосистемах с открытым ключом закрытый ключ всегда  матема-
тически  связан  с открытым ключом,  поэтому существует возможность
простейшей пассивной  атаки системы,  которая называется  _ 1атакой вы-
 _ 1числением закрытого ключа по открытому ключу . 0.
   Итак, пусть к информационному обмену подключается  _ 1злоумышленник . 0,
желающий прочесть сообщение m, и пусть ему удалось перехватить шифр
m 41 0, а из телефонной книги ему известны значения r 4B 0 и b.
   Теперь для перехвата сообщения m остаётся вычислить
 ш1.0

   m 42 7= 0 m 41 7И 0 ( 1mod 0 r 4B 0),

 ш1.2
но для этого необходимо определить закрытый ключ  7b 0, что  приводит к
определению  7f 0(r 4B 0).
   Это возможно в двух случаях. Рассмотрим  _ 1первый . 0.
   Если из  некоторых соображений известно разложение r 4B 0 на простые
множители r 4B 0=q 41 77 0q 42 0; тогда легко вычисляется
 ш1.0

                           ║            7( 0p 52 0-p,         если p 41 0=p 42 0=p;
    7f 0(r 4B 0)=  7f 0(q 41 0) 77f 0(q 42 0).     ║  7f 0(p 41 77 0p 42 0)=  7*
                           ║            79 0(p 41 0-1)(p 42 0-1), если p 41 7- 0p 42 0.

 ш1.2
   Наконец, решив сравнение
 ш1.0

    3e 77 3d 7= 2  01 ( 1mod 0  7f 0(r 4B 0))

 ш1.2
относительно  3d 0, восстановить закрытый ключ дешифрования.
   Все шаги  этого  алгоритма  могут  быть  организованы достаточно
быстро за  исключением первого:   _ 1разложение .  0r 4B 1  _на простые множители
составляет наиболее трудоёмкую часть вычислений.
   Разумеется, можно  "просеять"  m сквозь решето Эратосфена,  т.е.
проверить его на делимость всеми простыми числами от 2 до m 51/2 0.
   Однако, если использовать  _ 1интервальную оценку Чебышёва . 0 для коли-
чества простых чисел, не превосходящих натурального числа n
 ш1.0

     1ln 0(2)   n              n
    72 0───── 77 0─────, 2 77 1ln 0(2) 77 0───── 72 0,
    7[ 0  2    1ln 0(n)           1ln 0(n) 7]

 ш1.2
то находим,  что при m,  записываемом 100 десятичными цифрами, най-
дётся не менее 8 77 010 547 0 простых чисел, на которые придётся делить.
   Грубые оценки показывают,  что компьютеру,  выполняющему миллион
делений  в  секунду,  для разложения числа m>10 599 0 таким способом на
простые множители потребуется не менее 10 535 0 лет.
                  3Работа с примерами решённых задач
 ш1.1
   См. Пример 1, Пример 2.

 ш1.2
    3Замечание 0 [Утешев,Черкасов,Шапошников,2001,с.127].
 ш1.1
   Как только будет найден быстрый метод факторизации больших чисел
или изобретён алгоритм решения сравнения
 ш1.0

   x 5a 7= 0 b ( 1mod 0 m),

 ш1.1
не требующий предварительной факторизации модуля, использование ал-
горитма RSA для целей криптографии потеряет смысл.
   Использование этого алгоритма основано на уверенности в том, что
уж если за 300 последних лет не было создано универсального способа
факторизации,  то трудно ожидать, что он будет придуман нашими сов-
ременниками.
   С другой стороны, поскольку весь алгоритм использует лишь те ре-
зультаты теории чисел,  что получены классиками (а заслугой  совре-
менников является лишь их утилитарная интерпретация),  то наличест-
вует смутное опасение, что и алгоритмы быстрой факторизации класси-
кам тоже  _ 1могли . 0 быть известными.
   В одном из писем,  полученных П.Ферма, его корреспондент спраши-
вал, является ли число 100895598169 простым.
   В ответном  письме  П.Ферма  указал  разложение числа на простые
множители 112303 77 0898423. Как он это сделал?
   Похоже, что этот секрет не раскрыт до сих пор.

 ш1.2
                    22. 0  3Атака угадыванием значения
                           3функции Эйлера
   Теперь рассмотрим  _ 1второй случай . 0.
   Если злоумышленнику удалось узнать значение  7f 0(r 4B 0), но простые
числа q 41 0 и q 42 0 неизвестны ( 1но различны 0!).
   Тогда
 ш1.0

    7f 0(r 4B 0)=  7f 0(q 41 0) 77f 0(q 42 0)= (q 41 0-1) 77 0(q 42 0-1)= q 41 77 0q 42 0-(q 41 0+q 42 0)+1= r 4B 0-(q 41 0+q 42 0)+1.

 ш1.2
   С другой стороны,
 ш1.0

   (q 41 0-q 42 0) 52 0= (q 41 0+q 42 0) 52 0- 4q 41 0q 42 0= (q 41 0+q 42 0) 52 0-4r 4B 0.

 ш1.2
   В результате получается следующая система уравнений:
 ш1.0

    7( 0r 4B 0-(q 41 0+q 42 0)+1=  7f 0(r 4B 0);       7( 0q 41 0+q 42 0= r 4B 0- 7f 0(r 4B 0)+1;
    7* 0                       =>  7* 0         7|\\\\\\\\\\\ 0 =>
    79 0(q 41 0-q 42 0) 52 0= (q 41 0+q 42 0) 52 0-4r 4B 0     79 0q 41 0-q 42 0=  7? 0(q 41 0+q 42 0) 52 0-4r 4B

                  4┌ 0             7|\\\\\\\\\\\\\\\\ 4┐
         7( 0q 41 0=  51 0/ 42 77 0│r 4B 0- 7f 0(r 4B 0)+1+ 7? 0(r 4B 0- 7f 0(r 4B 0)+1) 52 0-4r 4B 0│;
        │         4└ 0                              4┘
     =>  7* 0         4┌ 0             7|\\\\\\\\\\\\\\\\ 4┐
        │q 42 0=  51 0/ 42 77 0│r 4B 0- 7f 0(r 4B 0)+1- 7? 0(r 4B 0- 7f 0(r 4B 0)+1) 52 0-4r 4B 0│.
         79 0         4└ 0                              4┘

 ш1.2
    2Пример 0 (по [Смарт,2005,с.196-197]).
 ш1.1
   Пусть злоумышленнику известны r 4B 0=18923 и  7f 0(r 4B 0)=18648. Тогда
 ш1.0

    7( 0q 41 0+q 42 0= r 4B 0- 7f 0(r 4B 0)+1;         7( 0q 41 0+q 42 0= 18923-18648+1= 276;
    7* 0                       =>  7* 0                           =>
    79 0(q 41 0-q 42 0) 52 0= (q 41 0+q 42 0) 52 0-4r 4B 0     79 0(q 41 0-q 42 0) 52 0= 484

                               7( 0q 41 0+q 42 0= 276;     7( 0q 41 0= 149;
                           =>  7* 0            =>  7*
                               79 0q 41 0-q 42 0= 22       79 0q 42 0= 127.

 ш1.2
   Защита от подобной атаки состоит в методах увеличения  сложности
получения закрытого ключа на основе открытого ключа.
   Например, некоторые асимметричные криптосистемы разработаны так,
что вычисление закрытого ключа на основе открытого требует разложе-
ния на множители настолько большого числа,  что при  _ 1современных . 0 (!)
вычислительных ресурсах это практически невозможно выполнить.
                    23. 0  3Атака с помощью разложения
                     3на множители методом Ферма 0
   Для того,  чтобы  было  сложнее  факторизовать N и решить  _ 1задачу
 _ 1RSA . 0 (!?),  p и q выбираются одинаковой битовой длины. Однако если p
и  q слишком близки друг к другу,  то появляется возможность доста-
точно быстро найти их с помощью  _ 1метода факторизации Ферма . 0.
   Пусть N  ═+ 0 p 77 0q, p 7, 0q, p и q - нечётные числа. Положим
 ш1.0

       p + q      q - p
   x  ═+ 0 ─────, y  ═+ 0 ───── => N= x 52 0-y 52 0= (x-y) 77 0(x+y).
         2          2

 ш1.2
   На этом основан следующий вариант алгоритма факторизации.
    _ 1Алгоритм . 0 [Ян,2011,с.104].
 ш1.1
   При известном нечётном целом  N>1  алгоритм  находит  наибольший
множитель, который не больше N 51/2 0.
 ш1.0

   (0) k:= 1+└N 51/2 0┘; y:= k 52 0-N; d:= 1;

   (1) если └y 51/2 0┘=y 51/2 0, то перейти к п.(3),
       иначе y:= y+2 77 0k+d; d:=d+2;

   (2) если └y 51/2 0┘< 5N 0/ 42 0, то перейти к п.(1),
       иначе вывести " 1Множители не найдены 0" и перейти к п.(4);

   (3) x:= (N+y) 51/2 0, y:= y 51/2 0 и вывести (x-y,x+y);

   (4) выход: завершение алгоритма.

 ш1.2
    2Теорема 0 [Ян,2011,с.104].
 ш1.1
   Пусть N  ═+ 0 p 77 0q, p>q, 7 D 0  ═+ 0 p-q.
   Тогда если   7D 0<N 51/4 0,  то  алгоритм  факторизации Ферма эффективно
раскладывает N на множители.

 ш1.2
   В частности, предлагается выбирать │q-p│>10 525 0.
                      24. 0  3Атака с использованием
                            3общего модуля
                         ( 1первый вариант 0)
   Пусть у всех абонентов сети  _ 1одинаковый модуль . 0 n и различные отк-
рытые и закрытые ключи.
   Рассмотрим открытый текст m и предположим,  что каким-то образом
криптоаналитику удалось вынудить только (!)  1двух 0 абонентов зашифро-
вать один и тот же текст.
   Пусть текст зашифрован на двух различных открытых ключах 3 e 41 0 и  3e 42
таких, что ( 3e 41 0, 3e 42 0)=1 (такие ключи можно просто поискать в "телефон-
ной книге" открытых ключей):
 ш1.0
         4e 0                 4e
   c 41 7= 0 m 5 1 1  0( 1mod 0 n), c 42 7= 0 m 5 2 1  0( 1mod 0 n).

 ш1.2
   Криптоаналитик знает что существуют такие числа r и s, что
 ш1.0

   r 77 3e 41 0 + s 77 3e 42 0= 1 ( 1обобщённая теорема Евклида 0),

 ш1.2
поэтому он решает полученное диафантово уравнение и получает r и s.
   Пусть r  является отрицательным числом (отрицательны должно быть
либо r, либо s).
   Теперь, вычислив c 41 5-1 0 по известному c 41 0, завершим взлом так:
 ш1.0

                  4┌ 0  4-e 0  4┐-r 0   4e *s 0    4r*e +s*e
   (c 41 5-1 0) 5-r 77 0c 42 5s 7= 0 │m 5  0  51 0│ 4   77 0m 5 2 0   7= 0 m    51 0   1  5 2 7= 0 m ( 1mod 0 n).
                  4└ 0     4┘

 ш1.2
   Атака завершилась успешно.
    _ 1Вывод . 0 [Шнайер,2002,с.528].
 ш1.1
   Не делайте n общим для группы пользователей.

 ш1.2
    2Пример 0.
 ш1.1
   Пусть Алиса желает послать Бобу сообщение m= 237135, а Боб жела-
ет послать Алисе такое же сообщение m= 237135 (предположим, что это
признание в любви!).
   У Алисы есть модуль n= _399799 . и открытый ключ Боба  3e 4B 0=4397, а Боб
имеет такой же модуль n= _399799 . (!) и открытый ключ Алисы  3e 4A 0=7517.
   Алиса зашифровывает сообщение открытым ключом Боба, т.е.
 ш1.0
     4e
   m  5B 0= c 41 0= 237135 54397 0= 268100 ( 1mod 0 399799)

 ш1.1
и посылает это число в открытый канал связи.
   Боб зашифровывает сообщение m открытым ключом Алисы, т.е.
 ш1.0
     4e
   m 4  5A 0= c 42 0= 237135 57517 0= 263851 ( 1mod 0 399799)

 ш1.1
и также посылает это число в открытый канал связи.
   Итак, криптоаналитик  Ева  знала  модуль n и открытые ключи  3e 4A 0 и
 3e 4B 0, а ей стали известны шифртексты c 41 0 и c 42 0.
   Далее Ева решает  _ 1диафантово уравнение . 0 (?!)
 ш1.0

    3e 4B 77 0x +  3e 4A 77 0y=1 => 4397 77 0x + 7517 77 0y= 1 => x=-1607, y= 940

 ш1.1
   Проверка выполняется элементарно: 4397 77 0(-1607) + 7517 77 0940= 1.
   Ева продолжает вычисления:
 ш1.0

   d 41 0= c 41 5|x| 0= 268100 51607 0= 12105 ( 1mod 0 399799),

но т.к. x<0, то остаётся вычислить d 41 5-1 0= 12105 5-1 0=39501 ( 1mod 0 399799);

   d 42 0= c 42 5y 0= 263851 5940 0= 362154 ( 1mod 0 399799).

 ш1.1
   Конечно, если бы y<0, то пришлось бы вычислить d 42 5-1 0.
   Далее, Ева продолжает вычисления и получает открытый текст:
 ш1.0

   d 41 5-1 77 0d 42 0= 39501 77 0362154= 237135 ( 1mod 0 399799)= m.

 ш1.2
                     24 41 2. 0  3Атака с использованием
                            3общего модуля
                         ( 1второй вариант 0)
   Четыре параметра {p,q, 3d 0, 7f 0(n)} являются  конфиденциальными  пара-
метрами RSA.  Знание значения хотя бы одного из них позволяет найти
другие три и решить соответствующую  _ 1задачу RSA . 0 (?!).
   Если параметры  используются  неправильно,  то решить задачу RSA
можно и без знания параметров {p,q, 3d 0, 7f 0(n)}.  Одним из примеров  не-
корректного использования  служит  повторное использование значения
параметра N при шифровании.
   Пусть Боб отправляет Алисе два шифртекста текста M:
 ш1.0
         4e 0               4e
   C 41 7= 0 M 5 1 1 mod 0 n, C 42 7= 0 M 5 2 1 mod 0 n, ( 3e 41 0, 3e 42 0)=1.

 ш1.2
    2Теорема 0 [Ян,2011,с.179].
 ш1.1
   Пусть n 41 0=n 42 0=n, M 41 0=M 42 0=M,  3e 41 7- 3e 42 0, ( 3e 41 0, 3e 42 0)=1, такие, что
 ш1.0
         4e 0               4e
   C 41 7= 0 M 5 1 1 mod 0 n, C 42 7= 0 M 5 2 1 mod 0 n, ( 3e 41 0, 3e 42 0)=1.

   Тогда M можно эффективно восстановить.

 ш1.2
    2Доказательство 0. Поскольку ( 3e 41 0, 3e 42 0)=1,  то существуют x,y 7е ═Z 0 такие,
что 3 e 41 77 0x +  3e 42 77 0y= 1;  при этом значения x и y могут быть получены  с
помощью обобщённого алгоритма Евклида. Отсюда получаем:
 ш1.0
             4┌ 0   4e 0  4┐x 0  4┌ 0   4e 0  4┐y 0    4e 0  4*x+e *y
   C 41 5x 77 0C 42 5y 7= 0 │M 41 5 1 0│  77 0│M 42 5 2 0│  7= 0 M 5 1 0   5  0  52 0   7= 0 M (mod n).
             4└ 0     4┘ 0   4└ 0     4┘

 ш1.2
    1Теорема доказана 0.
   Чтобы защититься  от  подобных атак на RSA,  наобходимо избегать
шифрования одного сообщения разными открытыми ключами с использова-
нием одного и того же параметра n криптосистемы RSA.
                    25. 0  3Атака с малой экспонентой
                     ( 1первый вариант описания 0)
   Пусть 3 e 0 - "маленький"   _ 1открытый . 0 ключ (например, 3), который  ис-
пользуется для зашифровывания одного и того же шифртекста m по раз-
личным модулям.
   Пусть n 41 0, n 42 0, n 43 0 являются  взаимно простыми числами, а соответс-
твующие шифртексты таковы:
 ш1.0

    7( 0 y 41 0= m 53 1 mod 0 n 41 0,
    7* 0 y 42 0= m 53 1 mod 0 n 42 0,
    79 0 y 43 0= m 53 1 mod 0 n 43 0.

 ш1.2
   Следовательно, m 53 0< n 41 77 0n 42 77 0n 43 0, поэтому мы можем найти m 53 0 с помощью
n 41 0, n 42 0, n 43 0, используя  _ 1китайскую теорему об остатках . 0, а затем вычис-
лить m путём извлечения кубического корня из m 53 0.
    _ 1Вывод . 0 [Шнайер,2002,с.529].
 ш1.1
   Дополняйте сообщение перед шифрованием случайными значениями;  в
результате размер m может быть даже примерно равным n.

 ш1.2
                    25. 0  3Атака с малой экспонентой
                     ( 1второй вариант описания 0)
   Пусть 3 e 0=3, что соответствует минимально возможному значению клю-
ча шифрования RSA, и пусть  _ 1трём . 0 (!) различным получателям были отп-
равлены одинаковые сообщения M, используя при этом следующие откры-
тые ключи
 ш1.0

   {( 3e 0,n 41 0),( 3e 0,n 42 0),( 3e 0,n 43 0)}, (n 4i 0,n 4j 0)=1, i 7- 0j, i,j=1,2,3.

 ш1.2
   Тогда M (M<n 4i 0) может быть быстро вычислено, а именно:
 ш1.0

    7( 0 C 41 7= 0 m 53 1 mod 0 n 41 0,     7( 0 m 53 7= 0 C 41 0  1mod 0 n 41 0,
    7* 0 C 42 7= 0 m 53 1 mod 0 n 42 0, =>  7* 0 m 53 7= 0 C 42 0  1mod 0 n 42 0,
    79 0 C 43 7= 0 m 53 1 mod 0 n 43 0      79 0 m 53 7= 0 C 43 0  1mod 0 n 43 0.

 ш1.2
   Теперь, применяя китайскую теорему об остатках, получим:
 ш1.0
                   4┌ 0                 4┐
   M 53 7= 0 C 41 77 0(n 42 77 0n 43 0) 77 0│(n 42 77 0n 43 0) 5-1 0 mod n 41 0│+
                   4└ 0                 4┘
                    4┌ 0                 4┐
      + C 42 77 0(n 41 77 0n 43 0) 77 0│(n 41 77 0n 43 0) 5-1 0 mod n 42 0│+
                    4└ 0                 4┘
                    4┌ 0                 4┐
      + C 43 77 0(n 41 77 0n 42 0) 77 0│(n 41 77 0n 42 0) 5-1 0 mod n 43 0│ (mod (n 41 77 0n 42 77 0n 43 0)).
                    4└ 0                 4┘

 ш1.2
   Остаётся извлечь кубический корень из M 53 0, M 53 0<n 41 77 0n 42 77 0n 43 0.
   Итак, криптоаналитик имеет возможность скомпрометировать RSA без
разложения n и без использования каких бы то ни было конфиденциаль-
ных параметров {p,q, 3q 0, 7f 0(n)}.
   Для защиты от атак,  основанных на малом значении 3 e 0,   _ 1не следует
 _ 1отправлять одинаковые сообщения несколько раз . 0, даже при использова-
нии различных модулей в различных сеансах работы алгоритма шифрова-
ния. При  увеличении 3  e 0  с 3 до 2 516 0+1=65637 и выполнении шифрования
следующим образом:
 ш1.0

    7( 0 C 41 7= 0 m 565537 1 mod 0 n 41 0,
    7* 0 C 42 7= 0 m 565537 1 mod 0 n 42 0,
    79 0 C 43 7= 0 m 565537 1 mod 0 n 43 0,

 ш1.2
значение m будет сложно вычислить, зная только C 41 0, C 42 0, C 43 0.
   Для вычисления m аналитик должен получить 65537 шифртекстов, что
почти невозможно,  потому что,  вероятно, никто не будет отправлять
одно и то же сообщение m 65537 различным получателям.

                    26. 0  3Атака методом неподвижной
                                3точки
                     ( 1первый вариант описания 0)

 ш1.0
                       1Мюллер не спал. Он только что получил сообще-
                       1ние из центра дешифровки 0: 1  шифр  русской  ра-
                       1дистки  совпадал  с шифром,  который пришёл в
                       1Берн.  Таким  образом,  предположил   Мюллер,
                       1русский резидент начал искать новую связь... 0
                               1Ю.Семёнов. Семнадцать мгновений весны
 ш1.2

   Пусть в  роли  криптоаналитика  выступает Ева,  которой известны
открытый ключ ( 3e 0,n) и шифртекст
 ш1.0

   С 7= 0 m 5e 0 (mod n).

 ш1.2
   Ева подбирает такое число k, для которого выполняется:
 ш1.0

         4k
   C 7= 0 С 5e 0 (mod n).

 ш1.2
   Таким образом,  Ева просто проводит k раз шифрование на открытом
ключе перехваченного шифртекста C, т.е.
 ш1.0

    4┌ 0            4┐ 0              4k 0            7f 0(n)-1  ═о 5Теорема Эйлера
   │((С 5e 0) 5e 0) ...│ 5e 0 (mod n) 7= 0 С 5e 0  (mod n) 7= 0 C       7= 0 C (mod n)
    4└ 0            4┘

 ш1.2
   Обнаружив такое k, Ева получает открытый текст m:
 ш1.0

        4┌ 0   4┐k 0            7f 0(n)-1
   С 5k 7= 0 │m 5e 0│  (mod n) 7= 0 m       7= 0 m (mod n),
        4└ 0   4┘

 ш1.2
    2Пример 0.
 ш1.1
   Пусть Алиса знает  n= 212887,  3e 0= 3061 (открытый ключ Боба) и же-
лает послать Бобу сообщение m= 193263.
   Поэтому она вначале зашифровывает сообщение, т.е.
 ш1.0

   m 5e 0= 193263 53061 0= С= 35947

 ш1.2
и посылает (ничего не подозревая!) число C в открытый канал связи.
   Итак, Еве были известны n и  3e 0, а теперь известно ещё и С.
   Ева вычисляет
 ш1.0

   С 5e 0  1mod 0 n= 35947 53061 0  1mod 0 212887.

 ш1.2
   Затем последовательными умножениями находит такое k,  что выпол-
няется
 ш1.0
      4k   0  4        k
   С 5e 0 = 35947 53061 0 = 35947= С => k= 1084.

   Наконец, Ева достигает цели вычислив

   С 5k 0= 35947 51084 0= 193263.

 ш1.2
                    26 41 2. 0  3Атака методом неподвижной
                                3точки
                     ( 1второй вариант описания 0)
   Эта атака не основывается на разложении n на множители и не  ис-
пользует ни один из конфиденциальных параметров RSA.  Она была отк-
рыта Г.Симонсом и М.Моррисом (1977).
    2Определение 0 [Ян,2011,с.181].
 ш1.1
   Пусть 7  00 7, 0x<n. Если
 ш1.0

     4e 5k
   x   7= 0 x (mod n), k 7е ═Z 5+ 0,

 ш1.1
то x называется  _ 1неподвижной точкой . 0  1RSA 0  _ 1порядка . 0  1k 0 с открытыми ключа-
ми ( 3e 0,n).

 ш1.2
    2Теорема 0 [Ян,2011,с.181].
 ш1.1
   Пусть C является неподвижной точкой RSA( 3e 0,n) порядка k. Тогда
 ш1.0
      4k 0                        4k-1
   C 5e 0  7= 0 C (mod n), k 7е ═Z 5+ 0 => C 5e 0    7= 0 M (mod n).

 ш1.2
    2Доказательство 0. Поскольку шифрование RSA C 7= 0 M 5e 0 (mod n)  является
перестановкой сообщений {0,1,2,...,n-1},  то существует неподвижная
точка
 ш1.0
      4k
   C 5e 0  7= 0 C (mod n).

   Далее легко получается:
                       4k 0                   4k-1
   C 7= 0 M 5e 0 (mod n) => C 5e 0  7= 0 M 5e 0 (mod n) => C 5e 0    7= 0 M (mod n).

 ш1.2
    1Теорема доказана 0.
   Эта теорема  описывает  способ  атаки на криптосистему RSA путём
вычисления последовательности степеней C по модулю n:
 ш1.0
          42 0     42    3 0         4k-1 0           4k
   C 5e 0, C 5e 0 , C 5e 0 , C 5e 0 ,..., C 5e 0   =M (*), C 5e 0 =C (**).

 ш1.2
   Таким образом,  когда получено равенство (**), мы прекращаем вы-
полнение алгоритма и берём предыдущий элемент (*),  который и будет
решением.
   Представим алгоритм следующим образом:
 ш1.0

    3e 0:=...; n:=...; C:=...;
   Для k от 1 до 100 выполнять
   {        4k
     A:= C 5e 0  mod n;
                         4k-1
     Если A=C, то M:= C 5e 0   mod n;
   }
   Вывести (k,M,C);

 ш1.2
    2Пример 0.
 ш1.1
   Пусть 3 e 0= 17, n= 2773, C= 2342 ( 1перехвачено 0) =>
 ш1.0
                   444 0                  443
          => C 7= 0 C 5e 0  (mod 2773), M 7= 0 C 5e 0  (mod n)= 1900.

 ш1.2
                        27. 0  3Атака на короткий
                           3открытый текст
   Если исходное  сообщение мало,  несмотря на то,  что шифртекст C
примерно такой же большой,  как и n (эта ситуация достаточно  часто
встречается в  применении  шифрования  с  открытым ключом,  которое
обычно используется  только  для  шифрования  коротких  сообщений),
то криптоаналитик  Ева может выполнить следующую последовательность
действий [Ян,2011,с.167]:
 ш1.1

   U 7= 0 C 77 0x 5-e 0 (mod n), V 7= 0 y 5e 0 (mod n)

 ш1.2
для всех 7  01 7, 0x,y 7, 010 59 0.
   Теперь если для некоторой пары (x,y) имеем U=V, то
 ш1.0

   C 77 0x 5-e 7= 0 y 5e 0 (mod n) => C 7= 0 (x 77 0y) 5e 0 (mod n) => M= x 77 0y.

 ш1.2
   Эта атака  может быть легко предотвращена путём добавления перед
шифрованием случайной последовательности битов  в   _ 1конце . 0  исходного
сообщения (этот  приём  называется   _ 1солтингом . 0) или добавлением нес-
кольких случайных битов в начале и в конце открытого текста m перед
его шифрованием (этот приём называется  _ 1выравниванием . 0),  чтобы сфор-
мировать длинный текст m.  Добавляемые случайные символы  удаляются
после расшифровывания.

                           28. 3 Атака Винера

 ш1.0
                1Жизнь нашу можно уподобить лежанию в бане на верхней
                1полочке.  Жарко,  душно и туманно. Веник делает своё
                1дело,  банный лист липнет,  и глазам больно от мыла.
                1Отовсюду  слышны возгласы 0: 1  поддай пару 0! 1  Тебе мылят
                1голову и перебирают все твои косточки. Хорошо 0!
                            1А.П.Чехов. Философские определения жизни
 ш1.2

   Пользователи часто склонны выбирать малый  показатель 3  d 0,  чтобы
уменьшить объём работы при возведении с степень.
   Например, когда смарт-карта используется для подписывания  сооб-
щений, она  должна вычислять степени C 5d 0 mod N.  Если вычислительная
мощность карты ограничена,  то удобно взять относительно малое зна-
чение 3 d 0 (конечно,  не настолько малое, чтобы  3d 0 можно было найти ис-
черпывающим поиском).
   Х.Винер ( 1H.Winer 0,  11990 0) с использованием свойств цепных дробей и
диофантовых приближений установил, что если закрытый ключ 3 d 0 крипто-
системы RSA принимает слишком малые значения, т.е. 3 d 0<N 51/4 0, то 3 d 0 мо-
жет бють вычислен за полиномиальное время  по  известному  значению
открытого ключа 3 e 0.
    2Теорема 0 ( 1Х.Винер 0) [Ян,2011,с.210].
 ш1.1
   Пусть N=p 77 0q, где p и q - простые числа, такие, что
 ш1.0

   q< p <2 77 0q, 3 d 0<  51 0/ 43 77 0N 51/4 0,

 ш1.1
тогда если дано 3 e 0 такое,  что 3 e 77 3d 7= 0 1 (mod  7f 0(N)),  значение 3 d 0  может
быть легко вычислено за полиномиальное время.

 ш1.2
   Эта теорема показывает,  что закрытый ключ 3  d 0  должен  принимать
достаточно большие значения (битовая длина должна быть примерно со-
поставима с битовой длиной n); в противном случае по свойствам цеп-
ных дробей закрытый ключ 3 d 0 может быть найден за полиномиальное вре-
мя (относительно N), т.е. будет легко получено исходное сообщение M.
    _ 1Алгоритм выполнения атаки Винера . 0.
    _ 1Вход . 0. Число N, открытый ключ 3 e 0.
    _ 1Выход . 0. Закрытый ключ 3 d 0.
 ш1.1
    21. 0 Представить 3 e 0/N в виде  _ 1непрерывной дроби . 0 (?!)
 ш1.0

   [0; d 41 0,d 42 0,...,d 4m 0].

 ш1.1
    22. 0  _ 1Для . 0 i=1,2,...,m  _ 1выполнить . 0 следующие действия:
    (а) вычислить  _ 1подходящую дробь . 0 (?!) P 4i 0/Q 4i 0;
    (б) проверить для произвольного сообщения M выполнимость
 ш1.0
     4┌ 0   4┐Q
    │M 5e 0│ 5 i 7= 0 M (mod N).
     4└ 0   4┘

   Если сравнение выполняется, то положить 3 d 0:=Q 4i 0.

 ш1.2
    2Пример 0 0.
 ш1.1
   Для N=160523347 атака Винера эффективна при 3 d 0<  51 0/ 43 77 0N 51/4 7~ 0 37.52,
а для N=8562942440499 - при  3d 0<  51 0/ 43 77 0N 51/4 7~ 0 770.6.

 ш1.2
    2Пример 0  21 0 (по [Ян,2011,с.211-214]).
 ш1.1
   Пусть даны N=160523347, 3 e 0=60728973. Тогда разложение числа 3 e 0/N в
цепную дробь будет выглядеть так:
 ш1.0

    3e 0/N= [0; 2, 1, 1, 1, 4, 12, 102, 1, 1, 2, 3, 2, 2, 36].

   Далее, получаем следующие подходящие дроби:

   [0;  51 0/ 42 0,  51 0/ 43 0,  52 0/ 45 0,  53 0/ 48 0,  514 0/ 437 0,  5171 0/ 4452 0,  517456 0/ 446141 0,
    517627 0/ 446593 0,  535083 0/ 492734 0,  587793 0/ 4232061 0,  5298462 0/ 4788917 0,
    5684717 0/ 41809895 0,  51667896 0/ 44408707 0,  560728973 0/ 4160523347 0].

 ш1.1
   Проверим, удовлетворяет ли случайно выбранное M сравнению
 ш1.0

   M 5ed 7= 0 M (mod N),

где 3 d 0 должна быть равна одному из следующих знаменателей

   {2, 3, 5, 8, 37, 452, 46141, 46593, 92734, 232061, 788917,
    1809895, 4408707, 160523347}

 ш1.1
подходящих дробей 3 e 0/N.  Естественно, что неизвестно заранее, какому
именно знаменателю будет равен закрытый ключ 3 d 0.
   Таким образом, нужно последовательно проверять:
 ш1.0

   2 52*e  0mod N= 137369160  7- 0 2,  2 58*e  0 mod N= 30960603   7- 0 2,
   2 53*e  0mod N= 93568289   7- 0 2,  2 537*e 0 mod N 5             0= 2,
   2 55*e  0mod N             7- 0 2,

после чего получаем  3d 0=37.

 ш1.2
    2Пример 0  22 0 (по [Ян,2011,с.214-215]).
 ш1.1
   Пусть даны N=28562942440499, 3  e 0=7502876735617.  Тогда разложение
числа 3 e 0/N в цепную дробь будет выглядеть так:
 ш1.0

    3e 0/N= [0; 3, 1, 4, 5, 1, 1, 3, 16, 1, 7, 1, 7, 1, 4, 1, 1, 2, 1,
            1, 3, 3, 4, 2, 2, 4, 12, 3, 2, 1, 2].

   Далее, получаем следующие подходящие дроби:

   [0;  51 0/ 43 0,  51 0/ 44 0,  55 0/ 419 0,  526 0/ 499 0,  531 0/ 4118 0,  557 0/ 4217 0,  5202 0/ 4769 0,...].

 ш1.1
   Искомое значение 3 d 0 должно быть одним из знаменателей перечислен-
ных выше подходящих дробей,  поэтому подставляем по очереди все по-
лученные знаменатели:
 ш1.0

   3 53*e  0  mod N  7- 0 3,  3 5769*e  0mod N = 3,
   3 54*e 0   5  0mod N  7- 0 3,
   3 5217*e  0mod N  7- 0 3,

 ш1.2
    2Пример 0  23 0 [Смарт,2005,с.355-356].
 ш1.1
   Пусть даны N=9449868410449, 3  e 0=6792605526025,  а  закрытый  ключ
криптосистемы удовлетворяет неравенству  3d 0<  51 0/ 43 77 0N 51/4 7~ 0 584.
   Разложим число 3 e 0/N в непрерывную дробь  и  проверим  знаменатель
каждой подходящей дроби: не является ли он закрытым ключом.
   Подходящие дроби разложения имеют вид:
 ш1.0

   1,  52 0/ 43 0,  53 0/ 44 0,  55 0/ 47 0,  518 0/ 425 0,  523 0/ 432 0,  5409 0/ 4569 0,  51659 0/ 42308 0,... => 3 d 0=569,

т.е. знаменатель седьмой подходящей дроби - искомый замкнутый ключ.

 ш1.2
    3Замечание 0 ( 1цепные дроби и система Maple 0).
 ш1.1
   Приведём сводку функций из Maple,  часть из которых подгружается
вызовом библиотеки numtheory.
    _ 1Преобразования цепных дробей . 0:
 ш1.1
   (1) cfrac - преобразование правильной дроби в цепную и обратно;
   (2) invcfrac  - вычисление  значения  бесконечной  периодической
цепной дроби;
   (3) nthconver - вычисление подходящей дроби с заданным номером;
   (4) nthnumer  - вычисление числителя подходящей дроби с заданным
номером;
   (5) nthdenom  - вычисление знаменателя подходящей дроби с задан-
ным номером.

 ш1.2
    3Замечание 0.
 ш1.1
   Так как значения 3 e 0 и  3d 0 определяют время зашифрования и  дешифро-
вания, то  можно  назвать ряд ситуаций,  в которых желательно иметь
малое значение 3 e 0 или  3d 0.
   Например, при  использовании  системы RSA при защите электронных
платежей с применением   _ 1кредитных  карточек . 0  естественным  является
требование использования  небольших значений 3 d 0 у владельца карточки
и большого значения 3 e 0 у центрального компьютера.

 ш1.2
               29. 0  3Атаки, основанные на анализе 0  3времени
                         3выполнения операций
   Подобные атаки  связаны не только со значениями конфиденциальных
параметров алгоритма, сколько с аппаратной реализацией RSA.
   П.Кочер ( 1P.Kocher 0, 1995) заметил, что замеряя время, необходимое
устройству (например,  смарткарте или компьютеру) на  шифрование  и
дешифрование, использующие  _ 1алгоритм возведения в степень по модулю . 0,
можно найти закрытый ключ 3 d 0 без разложения на множители числа n.
   Вариант защиты от такой атаки заключается в использования метода
"слепой" подписи: а именно:
 ш1.1
   (1) вычисляем C 7= 0 m 5e 0 (mod n);
   (2) генерируем случайное число r 7е ═Z 0, r<n, обеспечивая секретность
его значения;
   (3) вычисляем C' 7= 0 C 77 0r 5e 0 (mod n);
   (4) вычисляем m' 7= 0 (C') 5d 77 0r 5-1 0 (mod n);
   (5) вычисляем m 7= 0 m' 77 0r 5-1 0 (mod n).

 ш1.2
    2Теорема 0 [Ян,2011,с.234].
 ш1.1
   Справедливо сравнение
 ш1.0

   m 7= 0 m' 77 0r 5-1 0 (mod n).

 ш1.2
    2Доказательство 0.
 ш1.0

   m 7= 0 m' 77 0r 5-1 7= 0 (C') 5d 77 0r 5-1 7= 0 (C 77 0r 5e 0) 5d 77 0r 5-1 7= 0 C 5d 0 (mod n).

 ш1.2
    1Теорема доказана 0.

                      2Атаки с помощью выбранных
                             2шифртекстов

 ш1.0
                  1Время от времени Швейк развлекался тем, что снимал
                  1телефонную трубку и слушал.  Телефон был  новейшей
                  1системы,  недавно введённой в армии, и обладал тем
                  1преимуществом,  что можно  было  вполне  отчётливо
                  1слышать чужие телефонные разговоры по всей линии.
                          1Я.Гашек. Похождения бравого солдата Швейка
 ш1.2

                    21. 0  3Атака с помощью выбранного
                            3шифртекста-1
    2Лемма 0 ( 1важная 0).
 ш1.1
   Система RSA  обладает  _ 1мультипликативным . 0 ( _ 1гомоморфным . 0)  _ 1свойством . 0,
т.е. шифртекстом открытого текста вида m=m 41 77 0m 42 0 является
 ш1.0

   C 41 77 0C 42 0 ( 1mod 0 n).

 ш1.2
    2Доказательство 0. Если m 41 0,  m 42 0 - два различных открытых текста,  а
C 41 0, C 42 0 - соответствующие им шифртексты, то
 ш1.0

   (m 41 77 0m 42 0) 5e 7= 0 m 41 5e 77 0m 42 5e 7= 0 C 41 77 0C 42 0 ( 1mod 0 n).

 ш1.2
    1Лемма доказана 0.
   Это свойство  позволяет  осуществить   _ 1атаку по выбранному шифро-
 _ 1тексту . 0 и его нужно учитывать при совмещении схем шифрования на  ос-
нове RSA и цифровой подписи RSA.
   Пусть злоумышленник  Ева  перехватывает шифрованное сообщение от
Алиса к Бобу.
   Предположим, что Алиса передаёт в сеть число (напомним,  что 3 e 0 -
открытый ключ Боба)
 ш1.0

   c= m 5e 1 mod 0 n.

   Действия Боба таковы:

   m'= c 5d 1 mod 0 n,

 ш1.2
где c - текст, 3  0перехваченный Евой;  3d 0 - закрытый ключ Боба.
   Ева хочет прочесть текст m', для чего она выбирает число r, r<n,
и вычисляет с помощью открытого ключа 3 e 0 числа:
 ш1.0

   x= r 5e 1 mod 0 n, y= x 77 0c  1mod 0 n, t= r 5-1 0  1mod 0 n.

 ш1.2
   Из этих равенств легко получаются следующие утверждение:
 ш1.0

   x= r 5e 1 mod 0 n  => x 5d 0= r 5ed 1 mod 0 n => x 5d 0= r 1 mod 0 n => r= x 5d 0  1mod 0 n;

   t=  _r . 5-1 0  1mod 0 n => t= ( _x . 5d 0) 5-1 0  1mod 0 n => t= x 5-d 0  1mod 0 n.

 ш1.2
   Пусть Ева каким-то образом (обманом, силой, деньгами)  вынуждает
Боба "подписать" число y (естественно, своим закрытым ключом):
 ш1.0

   u= y 5d 0  1mod 0 n.

   Наконец, Ева вычисляет:

   t 77 0u  1mod 0 n= x 5-d 77 0y 5d 0  1mod 0 n= x 5-d 77 0(x 77 0c) 5d 0  1mod 0 n= c 5d 0  1mod 0 n= m'= m,

 ш1.2
и криптосхема взломана (!).

                    22. 0  3Атака с помощью выбранного
                            3шифртекста-2

 ш1.0
                                      1О заговоре королю известно,
                                      1Их письма удалось перехватить.
                                                   1Шекспир. Генрих V
 ш1.2

   Пусть злоумышленник  Ева  хочет  получить "подпись" на число N у
Алисы, но, к сожалению, Алиса категорически не желает этого делать.
   Тогда Ева выбирает произвольным образом число x и вычисляет
 ш1.0

   y= x 5e 0  1mod 0 n,

 ш1.2
где 3 e 0 - открытый ключ Алисы.
   Затем Ева вычисляет M=y 77 0N и вынуждает каким-то образом (обманом,
силой, деньгами) подписать число M у Алисы, т.е. получить число
 ш1.0

   z= M 5d 0  1mod 0 n.

 ш1.2
   Ева приступает к вычислениям
 ш1.0

   x 5-1 77 0z  1mod 0 n= x 5-1 77 0M 5d 0  1mod 0 n= x 5-1 77 0(y 77 0N) 5d 0  1mod 0 n=

              = x 5-1 77 0(x 5e 77 0N) 5d 0  1mod 0 n= x 5-1 77 0x 5ed 77 0N 5d 0  1mod 0 n= N 5d 0  1mod 0 n.

 ш1.2
   Итак, Ева получила "подпись" Алисы на текст N (!).
                    23. 0  3Атака с помощью выбранного
                            3шифртекста-3
   Пусть Ева хочет "подписать" у Алисы число  m 43 0, т.е. получить  от
Алисы число (напомним, что  3d 0 - закрытый ключ Алисы)
 ш1.0

   m 43 5d 0  1mod 0 n.

   Ева генерирует два вспомогательных сообщения m 41 0 и m 42 0 такие, что

   m 43 0= m 41 77 0m 42 0  1mod 0 n

 ш1.2
   Если теперь заставить Алису каким-то образом "подписать" уже це-
лых два (!) сообщения m 41 0 и m 42 0, то Ева добивается своей цели так:
 ш1.0

   m 43 0= m 41 77 0m 42 0  1mod 0 n => m 43 5d 0= (m 41 77 0m 42 0) 5d 0  1mod 0 n= (m 41 5d 0  1mod 0 n) 77 0(m 42 5d 0  1mod 0 n).

 ш1.2
   Итак, Ева получила "подпись" Алисы на текст m 43 0 (!).
    _ 1Выводы . 0 [Шнайер,2002,с.528].
 ш1.1
   Никогда не используйте алгоритм RSA для подписи случайных  доку-
ментов, "подсунутых" вам посторонними.
   Вначале всегда воспользуйтесь (однонаправленной) хэш-функцией.

 ш1.2
                    24. 0  3Атака с помощью выбранного
                            3шифртекста-4
   Пусть криптоаналитик Ева перехватывает  зашифрованный  текст  C,
который Боб послал Алисе. Действия Евы таковы:
   (а) Ева выбирает случайное число r>0 и вычисляет
 ш1.0

   M' 7= 0 r 5e 77 0C (mod n);

 ш1.2
   (б) Ева отправляет M' Алисе,  которая расшифровывает  сообщение,
вычисляя
 ш1.0

   C' 7= 0 M' 5d 7= 0 r 5ed 77 0C 5d 7= 0 C 5d 0 (mod n);

 ш1.2
   (в) если теперь Ева получит в своё распоряжение C', то
 ш1.0

   M 7= 0 r 5-1 77 0C 5d 77 0r 7= 0 C 5d 0.

 ш1.2
   В самом деле:
 ш1.0

   M 7= 0 r 5-1 77 0C' 7= 0 r 5-1 77 0C 5d 77 0r.
 ш1.2

              25. 0  3Атака на передачу связанных сообщений
                       3с малым открытым ключом 0

 ш1.0
                                   1Ключи расширили наши возможности.
                                                          1М.Булгаков
 ш1.2

   Алиса хочет  послать два секретных сообщения Бобу с малым ключом
 3e 0. Пусть n - модуль Боба.  Допустим,  что эти два сообщения связаны
линейно, т.е.
 ш1.0

   m 42 7= 0 a 77 0m 41 0 + b (mod n), a,b 7е ═Z 4n 0,

 ш1.2
и что Еве известно это линейное соотношение.
   Д.Копперсмит (1996) указал неожиданный  метод,  позволяющий  Еве
восстановить открытый текст m 41 0.
   Пусть 3 e 0=3, а шифровки сообщений m 41 0 и m 42 0 обозначаются C 41 0 и C 42 0 со-
ответственно, т.е.
 ш1.0

   C 41 7= 0 m 41 53 0 (mod n), C 42 7= 0 (a 77 0m 41 0+b) 53 0 (mod n).

   Тогда

       b 77 0(C 42 0 + 2a 53 77 0C 41 0 - b 53 0)
   m 41 7= 0 ─────────────────────.
       a 77 0(C 42 0 -  a 53 77 0C 41 0 + 2b 53 0)

 ш1.2
    2Пример 0 [Тилборг,2006,с.170].
 ш1.1
   Пусть сообщения m 41 0 и m 42 0 связаны сравнением m 42 7= 0 3 77 0m 41 0+5 (mod n),
 ш1.0

   n  ═+ 0 477310661, 3 e 0  ═+ 0 3, a  ═+ 0 3, b  ═+ 0 5, C 41 0  ═+ 0 5908795, C 42 0  ═+ 0 374480016.

   Тогда легко вычислить m 41 0= 321321321.
 ш1.2

                    2Атаки на сообщение и подпись

 ш1.0
                                           1Безмолвны Восток и Запад.
                                           1Зови, проклиная, кричи 0!
                                           1Я сам себя в доме запер
                                           1и сам проглотил ключи.
                                                   1Александр Володин
 ш1.2

                 21. 0  3Атака "зашифровать и подписать"
   Подписывать сообщение лучше всего  _ 1перед его шифрованием . 0,  но  на
практике этого правила обычно не придерживаются.
   В последнем случае при использовании RSA можно вскрыть  протоко-
лы, шифрующие сообщение до его подписания [Шнайер,2002,с.530].
   Пусть Алиса хочет послать сообщение Бобу.
   Вначале она шифрует его открытым ключом Боба, а затем подписыва-
ет своим закрытым ключом;  в результате зашифрованное и подписанное
сообщение выглядит так:
 ш1.0
          4e         d
   m 41 0= (m  5B 0  1mod 0 n 4B 0) 5 A 0  1mod 0 n 4A 0.

 ш1.2
   Покажем, как Боб может доказать, что Алиса послала ему совершен-
но другое сообщение m' (а не m).
   Вначале он применяет открытый ключ Алисы  3e 4A 0 и получает
 ш1.0
      4e 0     4e
   m 41 0  5A 0= m  5B 0  1mod 0 n 4B 0.

 ш1.2
   Теперь 4  0Боб пытается обмануть Алису вместо того,  чтобы использо-
вать далее свой закрытый ключ  3d 4B 0 и получить
 ш1.0

      4e 0  4d 0     4e d 0                  4e 0  4d
   m 41 0  5A 0  5B 0= m  5B 0  5B 0  1mod 0 n 4B 0 => m= m 41 0  5A 0  5B 0  1mod 0 n 4B 0.

 ш1.2
   Поэтому, т.к. Бобу известно разложение на множители числа n 4B 0 (он
сам его придумал),  то он умеет вычислять дискретные  логарифмы  по
основанию n 4B 0 и находит такое число x, для которого
 ш1.0

   m 41 5x 0= m  1mod 0 n 4B 0.

 ш1.2
   Далее, Боб публикует свой новый открытый ключ x 77 3e 4B 0, а также пов-
торно вычисляет закрытый ключ 4  3d 41B 0.
   Теперь Боб утверждает, что Алиса послала  ему сообщение  m 41 0, за-
шифрованное новым открытым ключом, т.е. она обманщица!
   В самом деле (это повторное выполнение протокола):
 ш1.0
          4xe         d 0               4e 0     4xe
   m 41 0= (m   5B 0  1mod 0 n 4B 0) 5 A 0  1mod 0 n 4A 0 => m 41 0  5A 0= m   5B 0  1mod 0 n 4B 0 =>

                         4e 0  4d 0      4xe 0  4d 0                   4e 0  4d
                   => m 41 0  5A 0  51B 0= m   5B 0  51B 0  1mod 0 n 4B 0 => m= m 41 0  5A 0  51B 0  1mod 0 n 4B 0.

 ш1.2
   Заметим, что использование хэш-функции не решает проблему.
   Однако проблема  разрешается при использовании  _ 1фиксированных . 0 (!)
ключей.
                      22. 0  3Атака с использованием
                          3"слепой" подписи
   Пусть даны ( 3e 0,n,M) и криптоаналитик Ева хочет вычислить цифровую
подпись S, т.е. вычислить S 7= 0 M 5d 0 (mod n), M - сообщение.
   Пусть ( 3e 0,n) и 3 d 0 - открытый и закрытый ключи Боба соответственно.
   Ева предпринимает следующие действия:
 ш1.1
   (а) она выбирает случайное число r, (r,n)=1 и вычисляет
 ш1.0

   M' 7= 0 r 5e 77 0M (mod n);

 ш1.1
   (б) Ева просит Боба подписать случайным  образом  сформированное
сообщение M', которое выглядит как значение хэш-функции;
   (в) пусть Боб подписывает сообщение M',  что означает,  что  Ева
получила
 ш1.0

   S' 7= 0 M' 5d 0 (mod n);

 ш1.1
   (г) теперь Ева может получить действительную подпись Боба:
 ш1.0

   S 7= 0 r 5-1 77 0S' (mod n).

 ш1.2
   Выполним обоснование предложенного протокола:
 ш1.0

   S 5e 7= 0 r 5-e 77 0S' 5e 7= 0 r 5-e 77 0(M' 5d 0) 5e 7= 0 r 5-e 77 0M' 7= 0 r 5-e 77 0r 5e 77 0M 7= 0 M (mod n).

 ш1.2
   Итак, Ева узнаёт действительную подпись Боба без знания закрыто-
го ключа 3 d 0, и Боб не сможет обнаружить подделку, поскольку
 ш1.0

   M 7= 0 S 5e 0 (mod n) => S 7= 0 M 5d 0 (mod n).

 ш1.2
    3Замеание 0  [Шнайер,2002,с.529].
 ш1.1
   На основании  перечисленных  атак можно сформулировать следующие
 _ 1ограничения алгоритма . RSA 0:
 ш1.1
   - знание одной пары закрытого/открытого ключей для данного моду-
ля позволяет взломщику разложить модуль на множители;
   - знание одной пары закрытого/открытого ключей для данного моду-
ля позволяет взломщику вычислить другие пары показателей, не разла-
гая модуль на множители;
   - в протоколах сетей связи, применяющих RSA, не должен использо-
ваться общий модуль;
   - для  предотвращения  вскрытия  малого открытого показателя все
сообщения должны быть дополнены случайными значениями;
   - закрытый ключ должен быть большим числом.
 ш1.2

             2ПРИМЕРЫ РЕШЕНИЯ НЕКОТОРЫХ ТИПОВ УПРАЖНЕНИЙ

 ш1.0
                                    1Эй вы, задние, делай как я 0!
                                    1Это значит - не надо за мной.
                                    1Колея эта - только моя,
                                    1Выбирайтесь своей колеёй 0!
                                      1В.Высоцкий. Чужая колея  0( 11973 0)
 ш1.2

                     3Использование пакета Maple
    2Пример 1. 0 Демонстрация   1простейшего 0 (!)  рабочего инструментария
из пакета символьных вычислений Maple для  _ 1взлома . 0 простейших  откры-
тых ключей шифрования криптосистемы с открытым ключом RSA.
 ш1.0

   > # 1
   > s:=ifactors(3273550829);
                  s:=[1, [[44159,1], [74131,1]]]

   > s[2][1][1]; s[2][2][1];
                           44159  74131

   > # 2
   > st:=time(): ifactors(3337224043); time()-st;
                    [1, [[45007,1], [74149,1]]]
                                0.

   > # 3
   > st:=time(): ifactors(3571723717); time()-st;
                    [1, [[70709,1], [50513,1]]]
                                0.

   > # 4
   > st:=time(): ifactors(3414621671); time()-st;
                    [1, [[34583,1], [98737,1]]]
                                0.

   > # 5
   > st:=time(): ifactors(3601800221); time()-st;
                    [1, [[60013,1], [60017,1]]]
                                0.

   > # 6
   > st:=time(): ifactors(8590000127); time()-st;
                   [1, [[65537,1], [131071,1]]]
                                0.

   > # 7
   > st:=time(): ifactors(3337460873); time()-st;
                   [1, [[25463,1], [131071,1]]]
                                0.

   > # 8
   > st:=time(): ifactors(5694996163); time()-st;
                    [1, [[80077,1], [71119,1]]]
                               0.015

   > # 9
   > st:=time(): ifactors(304061960677); time()-st;
                  [1, [[301013,1], [1010129,1]]]
                                0.

   > # 10
   > st:=time(): ifactors(357106915621); time()-st;
                   [1, [[707071,1], [505051,1]]]
                                0.

   > # 11
   > st:=time():
     s:=ifactors(17428130119190358656862844953928880399);
     time()-st;

    s:=[1, [[74814711058227731,1], [232950577134838830229,1]]]
                               22.4

   > s[2][1][1]; s[2][2][1];
                         74814711058227731
                       232950577134838830229

   > # 12
   > st:=time():
     s:=ifactors(77512957676264314053480251723654409833);
     time()-st;

    s:=[1,[[22658675568711936073,1], [3420895340559865121,1]]]
                              26.313

   > # 13
   > st:=time():
     s:=ifactors(323304894015216546587068731061060010043806210137);
     time()-st;

              s:=[1, [[8327499837983796879987241,1],
                     [38823764671905792801457,1]]]
                              335.589

   > s:=ifactors(723455046249226948033432764056917858874599
                 68779467); # 812.60 секунд

              s:=[1, [[29847125167578611167623851,1],
                     [2423868436867342784274017,1]]]
 ш1.2

    2Пример 2. 0 Демонстрация  _ 1взлома . 0 криптосистемы  с  открытым  ключом
RSA с помощью пакета символьных вычислений Maple.
   Поскольку в  Maple  буква D зарезервирована за оператором диффе-
ренцирования, ключ дешифрования обозначен через D1.
 ш1.0

   > with(numtheory);
   > E:=1925928379; # Взломщик знает первый открытый ключ
   > m:=3273550829; # Взломщик знает второй открытый ключ

                   E:=1925928379  m:=3273550829

   > # Собственно взлом второго ключа
   > s:=ifactors(m); p1:=s[2][1][1]; p2:=s[2][2][1];

                  s:=[1, [[44159,1], [74131,1]]]
                             p1:=44159
                             p2:=74131

   > # Контроль правильности взлома
   > m:=p1*p2; phM:=(p1-1)*(p2-1);

                  m:=3273550829  phM:=3273432540

   > # Вычисление секретного ключа D1
   > D1:=E&^(phi(phM)-1) mod phM;

                             D1:=56779

   > # Взломщик перехватил следующую шифровку m1:
   > # 1169117912 1244629799 2168855069 1243855092 0437023454
   > # 2762017513 0127848283 0047229456 2567946795 2860789969
   > # 3245731988 0034676752 1557331563 1308187811;
   > # ---------------------------------------------------------
   > # Взломщик выделяет блок шифровки (из некоторых соображений
   > # он знает или угадывает размеры блока)
   > m1:=1169117912;
                          m1:=1169117912

   > # Взломщик расшифровывает закодированный текст m1 с помощью
   > # секретного ключа D
   > m2:=m1&^D1 mod m;
                           m2:=401181420

   > # Взломщик к тому же узнал, что кодировка  символов является
   > # стандартной, поэтому, последовательно расшифровывая каждый
   > # блок, получим следующий исходный текст:
   > # "Гаснут во времени тонут в пространстве мысли событья мечты
   > #  корабли"
 ш1.2

                 2ЗАДАЧИ ДЛЯ САМОСТОЯТЕЛЬНОГО РЕШЕНИЯ

 ш1.0
                           1Изобретают только тогда, когда имитируют.
                                                            1Г.Башляр
 ш1.2

                   21. 0  3Простейший 0  3криптоанализ RSA
    3Замечание 0 ( 1важное 0) [Утешев,Черкасов,Шапошников,2001,с.71].
 ш1.1
    _ 1Стандартной кодировкой . 0 называется  следующая кодировка букв рус-
ского алфавита и символа " 1пробел 0":
 ш1.0

  ┌──┬──┬──┬──┬──┬───┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬
  │ а│ б│ в│ г│ д│е,ё│ ж│ з│ и│ й│ к│ л│ м│ н│ о│ п│ р│ с│ т│ у│ 7777
  ├──┼──┼──┼──┼──┼───┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼
  │01│02│03│04│05│ 06│07│08│09│10│11│12│13│14│15│16│17│18│19│20│ 7777
  └──┴──┴──┴──┴──┴───┴──┴──┴──┴──┴──┴──┴──┴──┴──┴──┴──┴──┴──┴──┴
                    ┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──┬──────┐
                  7777 0│ ф│ х│ ц│ ч│ ш│ щ│ ъ│ ы│ ь│ э│ ю│ я│ 1Пробел 0│
                    ┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──┼──────┤
                  7777 0│21│22│23│24│25│26│27│28│29│30│31│32│  00  │
                    ┴──┴──┴──┴──┴──┴──┴──┴──┴──┴──┴──┴──┴──────┘

 ш1.2
    21 4* 2. 0 [Утешев,Черкасов,Шапошников,2001,с.97-99]
   Взломав открытый ключ шифрования, прочитайте сообщения (открытый
текст закодирован  _ 1стандартной кодировкой . 0).
   В шифровках  1-8  длина блоков равна 10,  в шифровках 9-10 равна
12, в шифровках 11-12 равна 38, а в шифровке 13 равна 48.
 ш1.0

   (1) m= 3273550829, E= 1925928379,
       1169117912 1244629799 2168855069 1243855092 0437023454
       2762017513 0127848283 0047229456 2567946795 2860789969
       3245731988 0034676752 1557331563 1308187811;

   (2) m= 3337224043, E= 2344644737,
       3211612606 1208442100 2529758308 2762054337 1406507518
       1251992427 2442112810 0547056391 0568275910 3137778049
       2989017937 2820696238 2486694925;

   (3) m= 3571723717, E= 1054875165,
       3371389761 3108772900 2789090756 1702524865 1459737350
       3094823069 2426005999 3088333655 1346615411 2119806179
       1572525825 1397236295 0490884957 1694795075;

   (4) m= 3414621671, E= 627535223,
       2728903315 1427672020 2710570826 1168363236 2353416748
       0459131576 0634259134 3132407495 1814809280 2656246726
       1473949532 1041251468 2047712588;

   (5) m= 3601800221, E= 300140017,
       0100111701 2753015690 2201516922 3363274335 1518851909
       1806120100 3573090214 0306190003 0954217522 3363101814
       1887404463 1106001617 2744326638;

   (6) m= 8590000127, E= 3681419263,
       5289389833 0322445978 4488463867 6745107937 3431374889
       8532179333 3411484703 1285890029 2951679964 2820703034
       0838735447 1679852513

   (7) m= 3337460873, E= 825541727,
       0006181209 0504711138 2946944228 0603228516 1338276606
       2622465339 1543961568 2435259794 3186948955 1203023424
       2066199011 2413376881 2948791304 2834914982 1142922701;

   (8) m= 5694996163, E= 2676573121,
       1163219079 4668046830 0011216732 0309650467 3267065033
       1192514275 1212489158 5058346454 4345793196 4397102669
       5368937727 0949088697 5120945088 1192514275 1921390549
       0896888534 2535878443 4397102669;

   (9) m= 304061960677, E= 1251437711,
       009845336878 131918325363 200330796769 176207234138
       201318313310 148890103474 014807085093 255259487321
       059593707307 054728561148 190490857163 071144700575
       194450312531 278133682149 249837161637;

   (10) m= 357106915621, E= 182979752741,
        325172590473 343958407857 181997910876 256274850311
        012909887764;

   (11) m= 17428130119190358656862844953928880399,
        E= 7641232191248410654157,
        04945624150857327747472113001948209425;

   (12) m= 77512957676264314053480251723654409833,
        E= 65537,
        05466596792819218212234305511305291063
        20198134849315351291256415950980246911
        60568601691487730459566983298202883187;

   (13) m= 323304894015216546587068731061060010043806210137,
        E= 182564475735968835170568313036845173155699825601,
        298518555120973843005896884803656930744052264560
        214140117353937599348267918644229308388594182193.

 ш1.2
    22 4* 2. 0 (По [Утешев,Черкасов,Шапошников,2001,с.84-85])
   Спецслужбой перехвачена шифровка террориста
 ш1.0

   c= 31562390514325508322912233641018233293067940145944.

 ш1.2
   Известно, что сообщение состоит из одного блока, открытый  текст
закодирован  1стандартной кодировкой 0 и зашифрован ключом
 ш1.0

    3e 0= 3, m= 72345504624922694803343276405691785887459968779467.

 ш1.2
   Установите, за какое время спецслужба сможет дешифровать это со-
общение, если  в её распоряжении имеется компьютер с  установленной
системой компьютерной алгебры Maple.
 ш1.1
    _ 1Указание . 0. x= " 1бомба взорвётся через час 0".

 ш1.2
    23 4* 2. 0 Факторизуйте n= 4386607, если известно 7 f 0(n)= 4382136.
    24 4* 2. 0 Докажите, что если возможно угадать значение 7 f 0(n), n=p 77 0q, то
можно восстановить открытый текст m по соответствующему  шифртексту
C за полиномиальное время.
 ш1.1
    _ 1Указание . 0. Решите квадратное уравнение
 ш1.0

   p 52 0 - (n- 7f 0(n)+1) 77 0p + n= 0.

 ш1.2
                    22. 3 "Учебный" криптоанализ RSA
    21 4* 2. 0 Выполните следующие  1атаки на RSA 0, используя систему символь-
ных вычислений Maple:
 ш1.1
   (1) вычислением закрытого ключа по открытому ключу;
   (2) угадыванием значения функции Эйлера;
   (3) с помощью разложения на множители методом Ферма;

   (4) с использованием общего модуля;
   (5) с малой экспонентой;
   (6) методом неподвижной точки;
   (7) на короткий открытый текст;
   (8) атака Винера;

   (9)  с помощью выбранного шифртекста-1;
   (10) с помощью выбранного шифртекста-2;
   (11) с помощью выбранного шифртекста-3;
   (12) с помощью выбранного шифртекста-4;
   (13) атака на передачу связанных сообщений с малым открытым клю-
чом;

   (14) атака на зашифрование и цифровую подпись.

 ш1.2
    22 4* 2. 0 Докажите, что в системе RSA всегда найдутся  ключи  шифрова-
ния, переводящие все сообщения в себя.
   Приведите соответствующие примеры, используя модуль n.
 ш1.0

   (а) n= 33; (б) n= 55; (в) n= 77; (г) n= 65; (д) n= 91; (е) n=221.

 ш1.1
    _ 1Указание . 0. Пусть  n  - модуль, 3  e 0 - открытый ключ,  C - шифртекст
текста M в RSA. Тогда
 ш1.0

   C 7= 0 M 5e 0 (mod n),

 ш1.1
а если M= C, то M 7= 0 M 5e 0 (mod n) => M 5e-1 7= 0 1 (mod n).
   Вспомним, что если (M,n)=1, то
 ш1.0

     7f 0(n)
   M     7= 01 (mod n) => 3 e 0-1=  7f 0(n) =>  3e 0= 1+ 7f 0(n).

 ш1.2
    23. 0 [Осипян,Осипян,2004,с.111,№6.62]
   В системе RSA всегда найдутся такие экспоненты зашифрования, что
любой текст не меняется при зашифровании.
   Более точно, докажите следующее утверждение.
   Для любых  p  и  q экспонента 3 e 0 может быть выбрана так,  что для
всех w
 ш1.0

   w 5e 7= 0 w (mod n).

 ш1.2
   Тривиальные случаи 3 e 0= 1 и 3 e 0= 1+ 7f 0(n) исключаются.
    24. 0 [Романьков,2012,с.110,№10.3]
   ( 1Неподвижные точки в RSA 0.) При шифровании в RSA (n=p 77 0q, 3e 0, 3d 0) воз-
можны совпадения шифровки C и исходного текста m.
   Покажите, что число совпадений равно
 ш1.0
    4┌ 0                 4┐ 0  4┌ 0                 4┐
   │1 +  1gcd 0(p-1, 3e 0-1)│ 7& 0│1 +  1gcd 0(q-1, 3e 0-1)│.
    4└ 0                 4┘ 0  4└ 0                 4┘

 ш1.2
   Какой вывод можно сделать для правильного выбора p, q,  3e 0?
    25. 0 [Осипян,Осипян,2004,с.113,№6.76]
   Предположим, что в RSA p=127 и q=131.
   Сколько сообщений шифруется в себя для экспонент:
 ш1.0

   (1) 29; (2) 31.

 ш1.2
    26. 0 [Деза,Котова,2018,с.259]
   Разложите на множители число n=46648A118EA35141F5 416 0, если откры-
тый показатель 3 e 0=5, а сообщения m 41 0 и m 42 0 связаны соотношением
 ш1.0

   m 42 7= 0  7a7 0m 41 0+ 7b 0 (mod n),  7a 0  ═+ 0 3039 416 0,  7b 0  ═+ 0 12AFF 416 0,

и соответствующие шифртексты

   C 41 0  ═+ 0 11FFE80B617C5CEFC1 416 0, C 42 0  ═+ 0 2D1BD236C7D4B841F3 416 0.

 ш1.2
    27. 0 Рассмотрим систему RSA с пользователями Алисой и Бобом, моду-
ли которых соответственно равны n 4A 0 и n 4B 0.
   Реализуйте атаки в следующих случаях неудачных выборов n 4A 0 и n 4B 0:
 ш1.1
   (1) 4* 0 (n 4A 0,n 4B 0)= p, p 7- 01;
   (2) 4* 0 n 4A 0=n 4B 0, 3 e 4A 0= 3e 4B 0;
   (3) 4* 0 n 4A 0=n 4B 0, 3 e 4A 7- 3e 4B 0;
   (4) 5* 0 n 4A 0=n 4B 0, а извне криптосистемы приступает к работе криптоана-
литик Ева, которая может посылать сообщения и Алисе, и Бобу.

 ш1.1
    _ 1Указание . 0.

    2(3) 0 n 4A 0=p 77 0q => 7 f 0(n 4A 0)= (p-1) 77 0(q-1) => 3 e 4B 3d 4B 7= 0 1 (mod  7f 0(n 4A 0)) =>

              =>  3d 4B 7= 3 e 5-1 0 (mod  7f 0(n 4A 0)).

    2(4) 0 Ева посылает и Алисе, и Бобу сообщение M, т.е.
         4e 0                 4e
   C 4A 7= 0 M  5A 0 (mod n), C 4B 7= 0 M  5B 0 (mod n),

а также вычисляет
                                          t 77 3e 4A 0-1
   t 7= 3 e 4A 5-1 0 (mod  3e 4B 0) => t 77 3e 4A 0-1= k 77 3e 4B 0 => k= ──────, k 7е ═Z 0 =>
                                             3e 4B
                  4┌ 0  4e 0  4┐t 0  4┌ 0  4e 0  4┐-k   1+k*e 0   4 -k*e
    => C 4A 5t 77 0C 4B 5-k 7= 0 │M  5A 0│ 7 7 0│M  5B 0│   7= 0 M 5     B 77 0M 5    B 7= 0 M (mod n).
                  4└ 0    4┘ 0   4└ 0    4┘
 ш1.1
   Итак, различные пользователи (Алиса и  Боб)  RSA-системы  должны
иметь попарно взаимно простые RSA-модули.
 ш1.2

    _ 1Домашнее задание . 0:
 ш1.0

   №№  21 41(1,13),2 0;  22 41(1,2,3,4,5,6,7,8,9) 0 ( 112 задач 0).

 ш1.2
.
             3Соление и перчение 2: 3 повышение безопасности
                         3сохраненных паролей
   Когда дело доходит до безопасного хранения паролей, простого хе-
ширования паролей может быть недостаточно.
    _ 1Соление . 0 предполагает добавление уникального и случайно  сгенери-
рованного значения (известного как " _ 1соль . 0") к каждому  паролю  перед
его хешированием.
   "Соль" сохраняется вместе с хешированным паролем.
   Благодаря включению "соли", полученный хэш становится уникальным
для комбинации  исходного пароля и "соли".  Этот метод не позволяет
криптоаналитикам использовать  предварительно  вычисленные  таблицы
( 1радужной таблицы 0) для определения исходного пароля по хешу.
   Соление дает несколько преимуществ:
 ш1.1
   (1) это снижает уязвимость паролей,  создающих одно и то же зна-
чение хеш-функции,  поскольку  разная   1" 0соль 1" 0  приводит к получению
разных хэшей, даже если пароли одинаковы;
   (2) это увеличивает сложность и вычислительные затраты,  необхо-
димые для взлома хешированных паролей,  поскольку  криптоаналитикам
придётся генерировать новые радужные таблицы или вычислять хэши для
каждого "посоленного" пароля.

 ш1.2
    _ 1Перчение . 0 - это ещё один метод,  используемый для повышения безо-
пасности паролей, часто используемый в сочетании с "солью".
   В то  время как "соль" предполагает хранение соли вместе с паро-
лем,  перчение вводит дополнительное секретное значение, называемое
" _ 1перцем . 0", которое  остаётся  постоянным и хранится отдельно от базы
данных паролей и обычно представляет  собой  длинное,  случайное  и
 _ 1секретное значение . 0, известное только системе.
   При хешировании пароля "перец" объединяется с паролем,  а  полу-
ченная комбинация затем хэшируется.  Хэшированное значение сохраня-
ется в базе данных, а сам "перец" - нет.
   Преимущество использования  "перца"  заключается  в его дополни-
тельном уровне безопасности.  Даже если криптоаналитик получит дос-
туп к хешированным паролям,  ему всё равно потребуется знание "пер-
ца", чтобы взломать пароли. Это значительно увеличивает сложность и
усилия, необходимые для получения исходных паролей.
   Соление и перчение можно использовать вместе для повышения безо-
пасности пароля. При применении обоих метода, каждый пароль получа-
ет уникальную "соль", предотвращающую заранее рассчитанные атаки, а
дополнительный "перец"  добавляет дополнительный уровень секретнос-
ти,  защищая от несанкционированного доступа к паролям,  даже  если
база данных скомпрометирована.
.
